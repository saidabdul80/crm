import{C as A,D as T,E as j,f as ee,e as E,g as C,F as P,l as q,h as w,i as x,Z as ae,k as H,r as i,o as h,n as F,w as l,b as u,t as v,m as e,a,q as N,H as J,I as L,s as K,a3 as te,G as oe,c as R,p as ne,L as le}from"./main-4279fdc3.js";const se={class:"flex justify-between w-full"},de={class:"px-6 pt-6"},re={class:"font-medium text-lg text-left"},ie={class:"mt-2 text-sm leading-snug text-gray-500",style:{"max-width":"680px"}},ue=["onSubmit"],me={class:"p-4 sm:p-6 space-y-4"},pe={class:"z-0 flex justify-end p-4 bg-gray-50 border-modal-bg"},ce={setup(O){const r=A(),b=T(),I=j(),V=ee(),{t:S}=E();let m=C(!1);const t=P({id:r.selectedCompany.id,name:null}),$=q(()=>b.active&&b.componentName==="DeleteCompanyModal"),y={formData:{name:{required:w.withMessage(S("validation.required"),x),sameAsName:w.withMessage(S("validation.company_name_not_same"),ae(r.selectedCompany.name))}}},c=H(y,{formData:t},{$scope:!1});async function B(){if(c.value.$touch(),c.value.$invalid)return!0;const g=r.companies[0];m.value=!0;try{const _=await r.deleteCompany(t);console.log(_.data.success),_.data.success&&(p(),await r.setSelectedCompany(g),V.push("/admin/dashboard"),await I.setIsAppLoaded(!1),await I.bootstrap()),m.value=!1}catch{m.value=!1}}function U(){t.id=null,t.name="",c.value.$reset()}function p(){b.closeModal(),setTimeout(()=>{U(),c.value.$reset()},300)}return(g,_)=>{const M=i("BaseInput"),k=i("BaseInputGroup"),s=i("BaseButton"),o=i("BaseIcon"),D=i("BaseModal");return h(),F(D,{show:e($),onClose:p},{default:l(()=>[u("div",se,[u("div",de,[u("h6",re,v(e(b).title),1),u("p",ie,v(g.$t("settings.company_info.delete_company_modal_desc",{company:e(r).selectedCompany.name})),1)])]),u("form",{action:"",onSubmit:K(B,["prevent"])},[u("div",me,[a(k,{label:g.$t("settings.company_info.delete_company_modal_label",{company:e(r).selectedCompany.name}),error:e(c).formData.name.$error&&e(c).formData.name.$errors[0].$message,required:""},{default:l(()=>[a(M,{modelValue:e(t).name,"onUpdate:modelValue":_[0]||(_[0]=d=>e(t).name=d),invalid:e(c).formData.name.$error,onInput:_[1]||(_[1]=d=>e(c).formData.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),u("div",pe,[a(s,{class:"mr-3 text-sm",variant:"primary-outline",outline:"",type:"button",onClick:p},{default:l(()=>[N(v(g.$t("general.cancel")),1)]),_:1}),a(s,{loading:e(m),disabled:e(m),variant:"danger",type:"submit"},{left:l(d=>[e(m)?L("",!0):(h(),F(o,{key:0,name:"TrashIcon",class:J(d.class)},null,8,["class"]))]),default:l(()=>[N(" "+v(g.$t("general.delete")),1)]),_:1},8,["loading","disabled"])])],40,ue)]),_:1},8,["show"])}}},_e=["onSubmit"],fe={key:0,class:"py-5"},ye={class:"text-lg leading-6 font-medium text-gray-900"},ge={class:"mt-2 max-w-xl text-sm text-gray-500"},ve={class:"mt-5"},$e={setup(O){const r=A(),b=j(),I=T(),{t:V}=E(),S=te("utils");let m=C(!1);const t=P({name:null,logo:null,webhook_url:null,api_url:null,commission_percentage:null,address:{address_street_1:"",address_street_2:"",website:"",country_id:null,state:"",city:"",phone:"",zip:""}});S.mergeSettings(t,{...r.selectedCompany});let $=C([]),y=C(null),c=C(null);const B=C(!1);t.logo&&$.value.push({image:t.logo});const U=q(()=>({name:{required:w.withMessage(V("validation.required"),x),minLength:w.withMessage(V("validation.name_min_length"),oe(3))},address:{country_id:{required:w.withMessage(V("validation.required"),x)}}})),p=H(U,q(()=>t));b.fetchCountries();function g(s,o,D,d){c.value=d.name,y.value=o}function _(){y.value=null,B.value=!0}async function M(){if(p.value.$touch(),p.value.$invalid)return!0;if(m.value=!0,(await r.updateCompany(t)).data.data){if(y.value||B.value){let o=new FormData;y.value&&o.append("company_logo",JSON.stringify({name:c.value,data:y.value})),o.append("is_company_logo_removed",B.value),await r.updateCompanyLogo(o),y.value=null,B.value=!1}m.value=!1}m.value=!1}function k(s){I.openModal({title:V("settings.company_info.are_you_absolutely_sure"),componentName:"DeleteCompanyModal",size:"sm"})}return(s,o)=>{const D=i("BaseFileUploader"),d=i("BaseInputGroup"),G=i("BaseInputGrid"),f=i("BaseInput"),W=i("BaseMultiselect"),z=i("BaseTextarea"),Y=i("BaseIcon"),Z=i("BaseButton"),Q=i("BaseDivider"),X=i("BaseSettingCard");return h(),R(le,null,[u("form",{onSubmit:K(M,["prevent"])},[a(X,{title:s.$t("settings.company_info.company_info"),description:s.$t("settings.company_info.section_description")},{default:l(()=>[a(G,{class:"mt-5"},{default:l(()=>[a(d,{label:s.$t("settings.company_info.company_logo")},{default:l(()=>[a(D,{modelValue:e($),"onUpdate:modelValue":o[0]||(o[0]=n=>ne($)?$.value=n:$=n),base64:"",onChange:g,onRemove:_},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),a(G,{class:"mt-5"},{default:l(()=>[a(d,{label:s.$t("settings.company_info.company_name"),error:e(p).name.$error&&e(p).name.$errors[0].$message,required:""},{default:l(()=>[a(f,{modelValue:e(t).name,"onUpdate:modelValue":o[1]||(o[1]=n=>e(t).name=n),invalid:e(p).name.$error,onBlur:o[2]||(o[2]=n=>e(p).name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(d,{label:"API KEY"},{default:l(()=>[a(f,{disabled:!0,value:e(r).selectedCompany.api_key},null,8,["value"])]),_:1}),a(d,{label:"Commission Percentage"},{default:l(()=>[a(f,{disabled:e(r).selectedCompany.owner_id==""||e(r).selectedCompany.owner_id==null,modelValue:e(t).commission_percentage,"onUpdate:modelValue":o[3]||(o[3]=n=>e(t).commission_percentage=n)},null,8,["disabled","modelValue"])]),_:1}),a(d,{label:"Api URL"},{default:l(()=>[a(f,{modelValue:e(t).api_url,"onUpdate:modelValue":o[4]||(o[4]=n=>e(t).api_url=n)},null,8,["modelValue"])]),_:1}),a(d,{label:"Webhook URL"},{default:l(()=>[a(f,{modelValue:e(t).webhook_url,"onUpdate:modelValue":o[5]||(o[5]=n=>e(t).webhook_url=n)},null,8,["modelValue"])]),_:1}),a(d,{label:s.$t("settings.company_info.phone")},{default:l(()=>[a(f,{modelValue:e(t).address.phone,"onUpdate:modelValue":o[6]||(o[6]=n=>e(t).address.phone=n)},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{label:s.$t("settings.company_info.country"),error:e(p).address.country_id.$error&&e(p).address.country_id.$errors[0].$message,required:""},{default:l(()=>[a(W,{modelValue:e(t).address.country_id,"onUpdate:modelValue":o[7]||(o[7]=n=>e(t).address.country_id=n),label:"name",invalid:e(p).address.country_id.$error,options:e(b).countries,"value-prop":"id","can-deselect":!0,"can-clear":!1,searchable:"","track-by":"name"},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),a(d,{label:s.$t("settings.company_info.state")},{default:l(()=>[a(f,{modelValue:e(t).address.state,"onUpdate:modelValue":o[8]||(o[8]=n=>e(t).address.state=n),name:"state",type:"text"},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{label:s.$t("settings.company_info.city")},{default:l(()=>[a(f,{modelValue:e(t).address.city,"onUpdate:modelValue":o[9]||(o[9]=n=>e(t).address.city=n),type:"text"},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{label:s.$t("settings.company_info.zip")},{default:l(()=>[a(f,{modelValue:e(t).address.zip,"onUpdate:modelValue":o[10]||(o[10]=n=>e(t).address.zip=n)},null,8,["modelValue"])]),_:1},8,["label"]),u("div",null,[a(d,{label:s.$t("settings.company_info.address")},{default:l(()=>[a(z,{modelValue:e(t).address.address_street_1,"onUpdate:modelValue":o[11]||(o[11]=n=>e(t).address.address_street_1=n),rows:"2"},null,8,["modelValue"])]),_:1},8,["label"]),a(z,{modelValue:e(t).address.address_street_2,"onUpdate:modelValue":o[12]||(o[12]=n=>e(t).address.address_street_2=n),rows:"2",row:2,class:"mt-2"},null,8,["modelValue"])])]),_:1}),a(Z,{loading:e(m),disabled:e(m),type:"submit",class:"mt-6"},{left:l(n=>[e(m)?L("",!0):(h(),F(Y,{key:0,class:J(n.class),name:"SaveIcon"},null,8,["class"]))]),default:l(()=>[N(" "+v(s.$t("settings.company_info.save")),1)]),_:1},8,["loading","disabled"]),e(r).companies.length!==1?(h(),R("div",fe,[a(Q,{class:"my-4"}),u("h3",ye,v(s.$t("settings.company_info.delete_company")),1),u("div",ge,[u("p",null,v(s.$t("settings.company_info.delete_company_description")),1)]),u("div",ve,[u("button",{type:"button",class:"inline-flex items-center justify-center px-4 py-2 border border-transparent font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:text-sm",onClick:k},v(s.$t("general.delete")),1)])])):L("",!0)]),_:1},8,["title","description"])],40,_e),a(ce)],64)}}};export{$e as default};
