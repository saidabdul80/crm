import{E as H,C as T,g as y,l as k,A as h,aO as Y,r as _,aY as J,o as u,c as p,n as I,w as x,b as s,t as E,m as l,aa as A,aP as K,H as G,L as F,M as Q,I as L,a as D}from"./main-9a914193.js";import{u as W}from"./exchange-rate-938880b7.js";const X={class:"flex"},Z={class:"place-items-center bg-gray-500 rounded-s-md h-[32px] mt-[2px] p-2 w-[20%] text-sm text-white"},ee=s("option",null,"Select Currency",-1),te=["value"],re={key:0},oe=["value","addon"],ne={class:"flex items-center"},se={class:"text-gray-500 sm:text-sm mr-2"},ae=s("svg",{fill:"#444",height:"18px",width:"18px",version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 214.367 214.367","xml:space":"preserve",stroke:"#000000","stroke-width":"0.00214367"},[s("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),s("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round",stroke:"#CCCCCC","stroke-width":"0.42873399999999995"}),s("g",{id:"SVGRepo_iconCarrier"},[s("path",{d:"M202.403,95.22c0,46.312-33.237,85.002-77.109,93.484v25.663l-69.76-40l69.76-40v23.494 c27.176-7.87,47.109-32.964,47.109-62.642c0-35.962-29.258-65.22-65.22-65.22s-65.22,29.258-65.22,65.22 c0,9.686,2.068,19.001,6.148,27.688l-27.154,12.754c-5.968-12.707-8.994-26.313-8.994-40.441C11.964,42.716,54.68,0,107.184,0 S202.403,42.716,202.403,95.22z"})])],-1),ce=[ae],le={props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},store:{type:Object,default:null},storeProp:{type:String,default:""},isEdit:{type:Boolean,default:!1},isPayment:{type:Boolean,default:!1},customerCurrency:{type:[String,Number],default:null}},setup(o){var V,$;const e=o,d=H(),N=T(),S=W(),B=y(!1);let a=y(!1);e.store[e.storeProp].fliped=!1;const C=y(!0);d.fetchAccounts();const P=k(()=>N.selectedCompanyCurrency),f=y({}),b=k(()=>(f.value=d.accounts.find(r=>r.currency_id===e.store[e.storeProp].currency_id),f.value)),c=y({first:(V=f.value)==null?void 0:V.code,second:($=e.store[e.storeProp].paying_currency)==null?void 0:$.code}),j=k(()=>P.value.id!==e.customerCurrency);h(()=>e.store[e.storeProp].customer,r=>{U(r)},{deep:!0}),h(()=>e.store[e.storeProp].currency_id,r=>{q(r)},{immediate:!0}),h(()=>e.customerCurrency,r=>{r&&e.isEdit&&O()},{immediate:!0}),h(()=>d.areAccountsLoading,r=>{const t=e.store[e.storeProp].paying_currency_id;t&&d.accounts.forEach(n=>{n.currency_id==t&&(e.store[e.storeProp].paying_currency=n)})},{immediate:!0});function w(r=!1){var t,n,g,m;r&&(e.store[e.storeProp].fliped=!e.store[e.storeProp].fliped),e.store[e.storeProp].fliped?(c.value.first=(t=e.store[e.storeProp].paying_currency)==null?void 0:t.code,c.value.second=(n=f.value)==null?void 0:n.code):(c.value.first=(g=b.value)==null?void 0:g.code,c.value.second=(m=e.store[e.storeProp].paying_currency)==null?void 0:m.code)}function M(){var r,t,n;w(),((r=e.store[e.storeProp].paying_currency)==null?void 0:r.id)===((t=b.value)==null?void 0:t.id)?(C.value=!1,e.store[e.storeProp].paying_currency=null):(C.value=!0,e.store[e.storeProp].paying_currency_id=(n=e.store[e.storeProp].paying_currency)==null?void 0:n.id)}function O(){j.value&&S.checkForActiveProvider(e.customerCurrency).then(r=>{r.data.success&&(B.value=!0)})}function U(r){var t,n;r?e.store[e.storeProp].currency_id=(t=r.currency)==null?void 0:t.id:e.store[e.storeProp].currency_id=(n=P.value)==null?void 0:n.id}async function q(r){w(),r!==P.value.id?(!e.isEdit&&r&&await R(r),e.store.showExchangeRate=!0):e.store.showExchangeRate=!1}function R(r){a.value=!0,S.getCurrentExchangeRate(r).then(t=>{t.data&&!t.data.error&&(e.store[e.storeProp].exchange_rate=t.data.exchangeRate[0]),a.value=!1}).catch(t=>{a.value=!1})}return Y(()=>{e.store.showExchangeRate=!1}),(r,t)=>{const n=_("BaseInputGroup"),g=_("BaseIcon"),m=_("BaseInput"),z=J("tooltip");return u(),p(F,null,[o.isPayment?L("",!0):(u(),I(n,{key:0,label:"Currency Request"},{default:x(()=>{var i;return[s("div",X,[s("label",Z,E((i=l(b))==null?void 0:i.code)+" To",1),A(s("select",{"onUpdate:modelValue":t[0]||(t[0]=v=>o.store[o.storeProp].paying_currency=v),class:G([C.value?"border-gray-200":"border-red-500 focus:border-red-400 shake focus:ring-red-400 ","font-base w-[80%] sm:text-sm rounded-md text-black focus:border-gray-400"]),onChange:M},[ee,(u(!0),p(F,null,Q(l(d).accounts,v=>(u(),p("option",{value:v},E(v.name),9,te))),256))],34),[[K,o.store[o.storeProp].paying_currency]])])]}),_:1})),D(n,{"content-loading":l(a)&&!o.isEdit,label:r.$t("settings.exchange_rate.exchange_rate"),error:o.v.exchange_rate.$error&&o.v.exchange_rate.$errors[0].$message,required:""},{labelRight:x(()=>[B.value&&o.isEdit?(u(),p("div",re,[A(D(g,{name:"RefreshIcon",class:G(`h-4 w-4 text-primary-500 cursor-pointer outline-none ${l(a)?" animate-spin rotate-180 cursor-not-allowed pointer-events-none ":""}`),onClick:t[1]||(t[1]=i=>R(o.customerCurrency))},null,8,["class"]),[[z,{content:"Fetch Latest Exchange rate"}]])])):L("",!0)]),default:x(()=>[o.isPayment?(u(),p("input",{key:0,type:"text",class:"font-base w-[80%] sm:text-sm border-gray-200 rounded-md text-black focus:border-gray-400",value:o.store[o.storeProp].exchange_rate,addon:`1 ${c.value.first} =`,disabled:""},null,8,oe)):(u(),I(m,{key:1,modelValue:o.store[o.storeProp].exchange_rate,"onUpdate:modelValue":t[3]||(t[3]=i=>o.store[o.storeProp].exchange_rate=i),"content-loading":l(a)&&!o.isEdit,addon:`1 ${c.value.first} =`,disabled:l(a),onInput:t[4]||(t[4]=i=>o.v.exchange_rate.$touch())},{right:x(()=>[s("span",ne,[s("span",se,E(c.value.second),1),s("button",{class:"bg-white p-1 rounded-md active:animate-ping",onClick:t[2]||(t[2]=i=>w(!0)),type:"button"},ce)])]),_:1},8,["modelValue","content-loading","addon","disabled"]))]),_:1},8,["content-loading","label","error"])],64)}}};export{le as _};
