import{E as Y,C as J,g as y,l as b,A as x,aO as K,r as w,aY as Q,o as c,c as i,n as A,w as C,b as a,aa as k,aP as G,H as E,L as S,M as F,t as _,m,I as L,a as D}from"./main-4279fdc3.js";import{u as W}from"./exchange-rate-2c17694f.js";const X={class:"flex"},Z=a("option",null,"Select Currency",-1),ee=["value"],re=a("label",{class:"place-items-center bg-gray-500 h-[32px] mt-[2px] p-2 w-[20%] text-sm text-white"},"To",-1),te=a("option",null,"Select Currency",-1),oe=["value"],se={key:0},ne=["value","addon"],ae={class:"flex items-center"},ce={class:"text-gray-500 sm:text-sm mr-2"},ue=a("svg",{fill:"#444",height:"18px",width:"18px",version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 214.367 214.367","xml:space":"preserve",stroke:"#000000","stroke-width":"0.00214367"},[a("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),a("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round",stroke:"#CCCCCC","stroke-width":"0.42873399999999995"}),a("g",{id:"SVGRepo_iconCarrier"},[a("path",{d:"M202.403,95.22c0,46.312-33.237,85.002-77.109,93.484v25.663l-69.76-40l69.76-40v23.494 c27.176-7.87,47.109-32.964,47.109-62.642c0-35.962-29.258-65.22-65.22-65.22s-65.22,29.258-65.22,65.22 c0,9.686,2.068,19.001,6.148,27.688l-27.154,12.754c-5.968-12.707-8.994-26.313-8.994-40.441C11.964,42.716,54.68,0,107.184,0 S202.403,42.716,202.403,95.22z"})])],-1),le=[ue],fe={props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},store:{type:Object,default:null},storeProp:{type:String,default:""},isEdit:{type:Boolean,default:!1},isPayment:{type:Boolean,default:!1},customerCurrency:{type:[String,Number],default:null}},setup(o){var $,I;const e=o,d=Y(),N=J(),B=W(),R=y(!1);let u=y(!1);e.store[e.storeProp].fliped=!1;const f=y(!0);d.fetchAccounts();const P=b(()=>N.selectedCompanyCurrency),g=y({}),U=b(()=>(g.value=d.accounts.find(t=>t.currency_id===e.store[e.storeProp].currency_id),g.value)),l=y({first:($=g.value)==null?void 0:$.code,second:(I=e.store[e.storeProp].from_currency)==null?void 0:I.code}),j=b(()=>P.value.id!==e.customerCurrency);x(()=>e.store[e.storeProp].customer,t=>{z(t)},{deep:!0}),x(()=>e.store[e.storeProp].currency_id,t=>{H(t)},{immediate:!0}),x(()=>e.customerCurrency,t=>{t&&e.isEdit&&q()},{immediate:!0}),x(()=>d.areAccountsLoading,t=>{const r=e.store[e.storeProp].from_currency_id;r&&d.accounts.forEach(s=>{s.currency_id==r&&(e.store[e.storeProp].from_currency=s)})},{immediate:!0});function p(t=!1){var r,s,v,h;t&&(e.store[e.storeProp].fliped=!e.store[e.storeProp].fliped),e.store[e.storeProp].fliped?(l.value.first=(r=e.store[e.storeProp].from_currency)==null?void 0:r.code,l.value.second=(s=g.value)==null?void 0:s.code):(l.value.first=(v=U.value)==null?void 0:v.code,l.value.second=(h=e.store[e.storeProp].from_currency)==null?void 0:h.code)}function M(){var t,r,s;p(),((t=e.store[e.storeProp].currency)==null?void 0:t.id)===((r=e.store[e.storeProp].from_currency)==null?void 0:r.id)?(f.value=!1,e.store[e.storeProp].from_currency=null):(f.value=!0,e.store[e.storeProp].from_currency_id=(s=e.store[e.storeProp].from_currency)==null?void 0:s.id)}function O(){var t,r,s;p(),((t=e.store[e.storeProp].currency)==null?void 0:t.id)===((r=e.store[e.storeProp].from_currency)==null?void 0:r.id)?(f.value=!1,e.store[e.storeProp].currency=null):(f.value=!0,e.store[e.storeProp].currency_id=(s=e.store[e.storeProp].currency)==null?void 0:s.id)}function q(){j.value&&B.checkForActiveProvider(e.customerCurrency).then(t=>{t.data.success&&(R.value=!0)})}function z(t){var r,s;t?e.store[e.storeProp].currency_id=(r=t.currency)==null?void 0:r.id:e.store[e.storeProp].currency_id=(s=P.value)==null?void 0:s.id}async function H(t){p(),t!==P.value.id?(!e.isEdit&&t&&await V(t),e.store.showExchangeRate=!0):e.store.showExchangeRate=!1}function V(t){u.value=!0,B.getCurrentExchangeRate(t).then(r=>{r.data&&!r.data.error&&(e.store[e.storeProp].exchange_rate=r.data.exchangeRate[0]),u.value=!1}).catch(r=>{u.value=!1})}return K(()=>{e.store.showExchangeRate=!1}),(t,r)=>{const s=w("BaseInputGroup"),v=w("BaseIcon"),h=w("BaseInput"),T=Q("tooltip");return c(),i(S,null,[o.isPayment?L("",!0):(c(),A(s,{key:0,label:"Currency Exchange"},{default:C(()=>[a("div",X,[k(a("select",{"onUpdate:modelValue":r[0]||(r[0]=n=>o.store[o.storeProp].from_currency=n),class:E([f.value?"border-gray-200":"border-red-500 focus:border-red-400 shake focus:ring-red-400 ","font-base w-[80%] sm:text-sm rounded-md text-black focus:border-gray-400"]),onChange:M},[Z,(c(!0),i(S,null,F(m(d).accounts,n=>(c(),i("option",{value:n},_(n.name),9,ee))),256))],34),[[G,o.store[o.storeProp].from_currency]]),re,k(a("select",{"onUpdate:modelValue":r[1]||(r[1]=n=>o.store[o.storeProp].currency=n),class:E([f.value?"border-gray-200":"border-red-500 focus:border-red-400 shake focus:ring-red-400 ","font-base w-[80%] sm:text-sm rounded-md text-black focus:border-gray-400"]),onChange:O},[te,(c(!0),i(S,null,F(m(d).accounts,n=>(c(),i("option",{value:n},_(n.name),9,oe))),256))],34),[[G,o.store[o.storeProp].currency]])])]),_:1})),D(s,{"content-loading":m(u)&&!o.isEdit,label:t.$t("settings.exchange_rate.exchange_rate"),error:o.v.exchange_rate.$error&&o.v.exchange_rate.$errors[0].$message,required:""},{labelRight:C(()=>[R.value&&o.isEdit?(c(),i("div",se,[k(D(v,{name:"RefreshIcon",class:E(`h-4 w-4 text-primary-500 cursor-pointer outline-none ${m(u)?" animate-spin rotate-180 cursor-not-allowed pointer-events-none ":""}`),onClick:r[2]||(r[2]=n=>V(o.customerCurrency))},null,8,["class"]),[[T,{content:"Fetch Latest Exchange rate"}]])])):L("",!0)]),default:C(()=>[o.isPayment?(c(),i("input",{key:0,type:"text",class:"font-base w-[80%] sm:text-sm border-gray-200 rounded-md text-black focus:border-gray-400",value:o.store[o.storeProp].exchange_rate,addon:`1 ${l.value.first} =`,disabled:""},null,8,ne)):(c(),A(h,{key:1,modelValue:o.store[o.storeProp].exchange_rate,"onUpdate:modelValue":r[4]||(r[4]=n=>o.store[o.storeProp].exchange_rate=n),"content-loading":m(u)&&!o.isEdit,addon:`1 ${l.value.first} =`,disabled:m(u),onInput:r[5]||(r[5]=n=>o.v.exchange_rate.$touch())},{right:C(()=>[a("span",ae,[a("span",ce,_(l.value.second),1),a("button",{class:"bg-white p-1 rounded-md active:animate-ping",onClick:r[3]||(r[3]=n=>p(!0)),type:"button"},le)])]),_:1},8,["modelValue","content-loading","addon","disabled"]))]),_:1},8,["content-loading","label","error"])],64)}}};export{fe as _};
