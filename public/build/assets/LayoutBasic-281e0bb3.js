import{x as fe,y as ge,z as Q,A as Z,m as e,B as ve,f as W,C as H,D as J,E as P,e as X,g as B,F as be,l as j,h as R,i as G,G as se,k as le,r as g,o,n as V,w as s,b as l,q as M,t as y,a as t,c as p,H as N,I,s as ee,J as K,K as te,L,M as T,T as ie,N as xe,S as we,d as $e,O as q,P as Ce,Q as Y,R as ke,_ as Se,U as Be,u as Ie,V as Ve,W as Ee}from"./main-4279fdc3.js";import{u as ce}from"./exchange-rate-2c17694f.js";import{_ as Ue}from"./cowris-logo-black-c2c0856c.js";import{u as Me}from"./users-8d043ce5.js";import{N as Ae}from"./NotificationRoot-06cd2c8a.js";import{V as Le}from"./index.esm-b2b3b37b.js";function Fe(x){var c;const a=e(x);return(c=a==null?void 0:a.$el)!=null?c:a}const de=fe?window:void 0;function Re(...x){let c,a,i,_;if(ge(x[0])?([a,i,_]=x,c=de):[c,a,i,_]=x,!c)return Q;let u=Q;const f=Z(()=>e(c),r=>{u(),r&&(r.addEventListener(a,i,_),u=()=>{r.removeEventListener(a,i,_),u=Q})},{immediate:!0,flush:"post"}),v=()=>{f(),u()};return ve(v),v}function ue(x,c,a={}){const{window:i=de,event:_="pointerdown"}=a;return i?Re(i,_,f=>{const v=Fe(x);v&&(v===f.target||f.composedPath().includes(v)||c(f))},{passive:!0}):void 0}var re;(function(x){x.UP="UP",x.RIGHT="RIGHT",x.DOWN="DOWN",x.LEFT="LEFT",x.NONE="NONE"})(re||(re={}));const Ne={class:"flex justify-between w-full"},Te=["onSubmit"],qe={class:"p-4 mb-16 sm:p-6 space-y-4"},Oe={key:1,class:"flex flex-col items-center"},De={class:"z-0 flex justify-end p-4 bg-gray-50 border-modal-bg"},Ge={setup(x){const c=W(),a=H(),i=J(),_=P(),{t:u}=X();let f=B(!1),v=B(null),r=B(!1),h=B(null),m=B(null);const d=be({name:null,email:null,currency:"",address:{country_id:null}}),w=j(()=>i.active&&i.componentName==="CompanyModal"),C={newCompanyForm:{name:{required:R.withMessage(u("validation.required"),G),minLength:R.withMessage(u("validation.name_min_length",{count:3}),se(3))},email:{required:R.withMessage("Company email is required",G),minLength:R.withMessage(u("validation.name_min_length",{count:6}),se(6))},address:{country_id:{required:R.withMessage(u("validation.required"),G)}},currency:{required:R.withMessage(u("validation.required"),G)}}},n=le(C,{newCompanyForm:d});async function k(){r.value=!0,await _.fetchCurrencies(),await _.fetchCountries(),d.currency=a.selectedCompanyCurrency.id,d.address.country_id=a.selectedCompany.address.country_id,r.value=!1}function E(U,b){m.value=U,h.value=b}function S(){m.value=null,h.value=null}async function A(){if(n.value.newCompanyForm.$touch(),n.value.$invalid)return!0;f.value=!0;try{const U=await a.addNewCompany(d);if(U.data.data){if(await a.setSelectedCompany(U.data.data),h&&h.value){let b=new FormData;b.append("company_logo",JSON.stringify({name:m.value,data:h.value})),await a.updateCompanyLogo(b),c.push("/admin/dashboard")}await _.setIsAppLoaded(!1),await _.bootstrap(),z()}f.value=!1}catch{f.value=!1}}function O(){d.name="",d.currency="",d.address.country_id="",n.value.$reset()}function z(){i.closeModal(),setTimeout(()=>{O(),n.value.$reset()},300)}return(U,b)=>{const ae=g("BaseIcon"),me=g("BaseContentPlaceholdersBox"),pe=g("BaseContentPlaceholders"),_e=g("BaseFileUploader"),F=g("BaseInputGroup"),D=g("BaseInput"),ne=g("BaseMultiselect"),he=g("BaseInputGrid"),oe=g("BaseButton"),ye=g("BaseModal");return o(),V(ye,{show:e(w),onClose:z,onOpen:k},{header:s(()=>[l("div",Ne,[M(y(e(i).title)+" ",1),t(ae,{name:"XIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:z})])]),default:s(()=>[l("form",{action:"",onSubmit:ee(A,["prevent"])},[l("div",qe,[t(he,{layout:"one-column"},{default:s(()=>[t(F,{"content-loading":e(r),label:U.$t("settings.company_info.company_logo")},{default:s(()=>[e(r)?(o(),V(pe,{key:0},{default:s(()=>[t(me,{rounded:!0,class:"w-full h-24"})]),_:1})):(o(),p("div",Oe,[t(_e,{"preview-image":e(v),base64:"",onRemove:S,onChange:E},null,8,["preview-image"])]))]),_:1},8,["content-loading","label"]),t(F,{label:U.$t("settings.company_info.company_name"),error:e(n).newCompanyForm.name.$error&&e(n).newCompanyForm.name.$errors[0].$message,"content-loading":e(r),required:""},{default:s(()=>[t(D,{modelValue:e(d).name,"onUpdate:modelValue":b[0]||(b[0]=$=>e(d).name=$),invalid:e(n).newCompanyForm.name.$error,"content-loading":e(r),onInput:b[1]||(b[1]=$=>e(n).newCompanyForm.name.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","error","content-loading"]),t(F,{label:"Email",error:e(n).newCompanyForm.name.$error&&e(n).newCompanyForm.name.$errors[0].$message,"content-loading":e(r),required:""},{default:s(()=>[t(D,{modelValue:e(d).email,"onUpdate:modelValue":b[2]||(b[2]=$=>e(d).email=$),invalid:e(n).newCompanyForm.email.$error,"content-loading":e(r),onInput:b[3]||(b[3]=$=>e(n).newCompanyForm.email.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["error","content-loading"]),t(F,{label:"Commission Percentage","content-loading":e(r),required:""},{default:s(()=>[t(D,{modelValue:e(d).commission_percentage,"onUpdate:modelValue":b[4]||(b[4]=$=>e(d).commission_percentage=$),"content-loading":e(r)},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading"]),t(F,{label:"Api URL","content-loading":e(r),required:""},{default:s(()=>[t(D,{modelValue:e(d).api_url,"onUpdate:modelValue":b[5]||(b[5]=$=>e(d).api_url=$),"content-loading":e(r)},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading"]),t(F,{label:"Webhook URL","content-loading":e(r),required:""},{default:s(()=>[t(D,{modelValue:e(d).webhook_url,"onUpdate:modelValue":b[6]||(b[6]=$=>e(d).webhook_url=$),"content-loading":e(r)},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading"]),t(F,{"content-loading":e(r),label:U.$t("settings.company_info.country"),error:e(n).newCompanyForm.address.country_id.$error&&e(n).newCompanyForm.address.country_id.$errors[0].$message,required:""},{default:s(()=>[t(ne,{modelValue:e(d).address.country_id,"onUpdate:modelValue":b[7]||(b[7]=$=>e(d).address.country_id=$),"content-loading":e(r),label:"name",invalid:e(n).newCompanyForm.address.country_id.$error,options:e(_).countries,"value-prop":"id","can-deselect":!0,"can-clear":!1,searchable:"","track-by":"name"},null,8,["modelValue","content-loading","invalid","options"])]),_:1},8,["content-loading","label","error"]),t(F,{label:U.$t("wizard.currency"),error:e(n).newCompanyForm.currency.$error&&e(n).newCompanyForm.currency.$errors[0].$message,"content-loading":e(r),"help-text":U.$t("wizard.currency_set_alert"),required:""},{default:s(()=>[t(ne,{modelValue:e(d).currency,"onUpdate:modelValue":b[8]||(b[8]=$=>e(d).currency=$),"content-loading":e(r),options:e(_).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",placeholder:U.$t("settings.currencies.select_currency"),invalid:e(n).newCompanyForm.currency.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading","help-text"])]),_:1})]),l("div",De,[t(oe,{class:"mr-3 text-sm",variant:"primary-outline",outline:"",type:"button",onClick:z},{default:s(()=>[M(y(U.$t("general.cancel")),1)]),_:1}),t(oe,{loading:e(f),disabled:e(f),variant:"primary",type:"submit"},{left:s($=>[e(f)?I("",!0):(o(),V(ae,{key:0,name:"SaveIcon",class:N($.class)},null,8,["class"]))]),default:s(()=>[M(" "+y(U.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,Te)]),_:1},8,["show"])}}},je={key:0,class:"w-16 text-sm font-medium truncate sm:w-auto"},Pe={key:0,class:"absolute right-0 mt-2 bg-white rounded-md shadow-lg"},ze={class:"overflow-y-auto scrollbar-thin scrollbar-thumb-rounded-full w-[250px] max-h-[350px] scrollbar-thumb-gray-300 scrollbar-track-gray-10 pb-4"},We={class:"px-3 py-2 text-xs font-semibold text-gray-400 mb-0.5 block uppercase"},He={key:0,class:"flex flex-col items-center justify-center p-2 px-3 mt-4 text-base text-gray-400"},Je={key:1},Xe={key:0},Ke=["onClick"],Qe={class:"flex items-center"},Ye={class:"flex items-center justify-center mr-3 overflow-hidden text-base font-semibold bg-gray-200 rounded-md w-9 h-9 text-primary-500"},Ze={key:0},et=["src"],tt={class:"flex flex-col"},at={class:"text-sm"},nt={class:"font-medium"},ot={setup(x){const c=H(),a=J(),i=K(),_=W(),u=P(),{t:f}=X(),v=te(),r=B(!1),h=B(""),m=B(null);Z(i,()=>{r.value=!1,h.value=""}),ue(m,()=>{r.value=!1});function d(n){if(n)return n.split(" ")[0].charAt(0).toUpperCase()}function w(){a.openModal({title:f("company_switcher.new_company"),componentName:"CompanyModal",size:"sm"})}async function C(n){await c.setSelectedCompany(n),_.push("/admin/dashboard"),await u.setIsAppLoaded(!1),await u.bootstrap()}return(n,k)=>{const E=g("BaseIcon");return o(),p("div",{ref:(S,A)=>{A.companySwitchBar=S,m.value=S},class:"relative rounded"},[t(Ge),l("div",{class:"flex items-center justify-center px-3 h-8 md:h-9 ml-2 text-sm text-white bg-white rounded cursor-pointer bg-opacity-20",onClick:k[0]||(k[0]=S=>r.value=!r.value)},[e(c).selectedCompany?(o(),p("span",je,y(e(c).selectedCompany.name),1)):I("",!0),t(E,{name:"ChevronDownIcon",class:"h-5 ml-1 text-white"})]),t(ie,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:s(()=>[r.value?(o(),p("div",Pe,[l("div",ze,[l("label",We,y(n.$t("company_switcher.label")),1),e(c).companies.length<1?(o(),p("div",He,[t(E,{name:"ExclamationCircleIcon",class:"h-5 text-gray-400"}),M(" "+y(n.$t("company_switcher.no_results_found")),1)])):(o(),p("div",Je,[e(c).companies.length>0?(o(),p("div",Xe,[(o(!0),p(L,null,T(e(c).companies,(S,A)=>(o(),p("div",{key:A,class:N(["p-2 px-3 rounded-md cursor-pointer hover:bg-gray-100 hover:text-primary-500",{"bg-gray-100 text-primary-500":e(c).selectedCompany.id===S.id}]),onClick:O=>C(S)},[l("div",Qe,[l("span",Ye,[S.logo?(o(),p("img",{key:1,src:S.logo,alt:"Company logo",class:"w-full h-full object-contain"},null,8,et)):(o(),p("span",Ze,y(d(S.name)),1))]),l("div",tt,[l("span",at,y(S.name),1)])])],10,Ke))),128))])):I("",!0)]))]),e(v).currentUser.is_owner?(o(),p("div",{key:0,class:"flex items-center justify-center p-4 pl-3 border-t-2 border-gray-100 cursor-pointer text-primary-400 hover:text-primary-500",onClick:w},[t(E,{name:"PlusIcon",class:"h-5 mr-2"}),l("span",nt,y(n.$t("company_switcher.add_new_company")),1)])):I("",!0)])):I("",!0)]),_:1})],512)}}},st={key:0,class:"scrollbar-thin scrollbar-thumb-rounded-full scrollbar-thumb-gray-300 scrollbar-track-gray-100 overflow-y-auto bg-white rounded-md mt-2 shadow-lg p-3 absolute w-[300px] h-[200px] right-0"},rt={key:0,class:"flex items-center justify-center text-gray-400 text-base flex-col mt-4"},lt={key:1},it={key:0},ct={class:"text-sm text-gray-400 mb-0.5 block px-2 uppercase"},dt={class:"flex items-center justify-center w-9 h-9 mr-3 text-base font-semibold bg-gray-200 rounded-full text-primary-500"},ut={class:"flex flex-col"},mt={class:"text-sm"},pt={key:0,class:"text-xs text-gray-400"},_t={key:1,class:"text-xs text-gray-400"},ht={key:1,class:"mt-2"},yt={class:"text-sm text-gray-400 mb-2 block px-2 mb-0.5 uppercase"},ft={class:"flex items-center justify-center w-9 h-9 mr-3 text-base font-semibold bg-gray-200 rounded-full text-primary-500"},gt={class:"flex flex-col"},vt={class:"text-sm"},bt={class:"text-xs text-gray-400"},xt={setup(x){const c=Me(),a=B(!1),i=B(""),_=B(null),u=B(!1),f=K();Z(f,()=>{a.value=!1,i.value=""}),v=xe.exports.debounce(v,500),ue(_,()=>{a.value=!1,i.value=""});function v(){let h={search:i.value};i.value&&(u.value=!0,c.searchUsers(h).then(()=>{a.value=!0}),u.value=!1),i.value===""&&(a.value=!1)}function r(h){if(h)return h.split(" ")[0].charAt(0).toUpperCase()}return(h,m)=>{const d=g("BaseIcon"),w=g("BaseInput"),C=g("router-link");return o(),p("div",{ref:(n,k)=>{k.searchBar=n,_.value=n},class:"hidden rounded md:block relative"},[l("div",null,[t(w,{modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=n=>i.value=n),placeholder:"Search...","container-class":"!rounded",class:"h-8 md:h-9 !rounded",onInput:v},{left:s(()=>[t(d,{name:"SearchIcon",class:"text-gray-400"})]),right:s(()=>[u.value?(o(),V(we,{key:0,class:"h-5 text-primary-500"})):I("",!0)]),_:1},8,["modelValue"])]),t(ie,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:s(()=>[a.value?(o(),p("div",st,[e(c).userList.length<1&&e(c).customerList.length<1?(o(),p("div",rt,[t(d,{name:"ExclamationCircleIcon",class:"text-gray-400"}),M(" "+y(h.$t("global_search.no_results_found")),1)])):(o(),p("div",lt,[e(c).customerList.length>0?(o(),p("div",it,[l("label",ct,y(h.$t("global_search.customers")),1),(o(!0),p(L,null,T(e(c).customerList,(n,k)=>(o(),p("div",{key:k,class:"p-2 hover:bg-gray-100 cursor-pointer rounded-md"},[t(C,{to:{path:`/admin/customers/${n.id}/view`},class:"flex items-center"},{default:s(()=>[l("span",dt,y(r(n.name)),1),l("div",ut,[l("span",mt,y(n.name),1),n.contact_name?(o(),p("span",pt,y(n.contact_name),1)):(o(),p("span",_t,y(n.email),1))])]),_:2},1032,["to"])]))),128))])):I("",!0),e(c).userList.length>0?(o(),p("div",ht,[l("label",yt,y(h.$t("global_search.users")),1),(o(!0),p(L,null,T(e(c).userList,(n,k)=>(o(),p("div",{key:k,class:"p-2 hover:bg-gray-100 cursor-pointer rounded-md"},[t(C,{to:{path:`/admin/users/${n.id}/edit`},class:"flex items-center"},{default:s(()=>[l("span",ft,y(r(n.name)),1),l("div",gt,[l("span",vt,y(n.name),1),l("span",bt,y(n.email),1)])]),_:2},1032,["to"])]))),128))])):I("",!0)]))])):I("",!0)]),_:1})],512)}}},wt={class:"fixed top-0 left-0 z-20 flex items-center justify-between w-full px-4 py-3 md:h-16 md:px-8 bg-gradient-to-r from-gray-900 to-gray-500"},$t=l("img",{src:Ue,class:"h-6"},null,-1),Ct=["onClick"],kt={class:"flex float-right h-8 m-0 list-none md:h-9"},St={key:0,class:"relative hidden float-left m-0 md:block"},Bt={class:"flex items-center justify-center w-8 h-8 ml-2 text-sm text-black bg-white rounded md:h-9 md:w-9"},It={class:"ml-2"},Vt={class:"relative block float-left ml-2"},Et=["src"],Ut={setup(x){const c=$e(),a=te(),i=P(),_=W(),u=j(()=>a.currentUser&&a.currentUser.avatar!==0?a.currentUser.avatar:f());j(()=>i.globalSettings.admin_portal_logo?"/storage/"+i.globalSettings.admin_portal_logo:!1);function f(){return"imgUrl"}function v(){return a.hasAbilities([q.CREATE_INVOICE,q.CREATE_ESTIMATE,q.CREATE_CUSTOMER])}async function r(){await c.logout(),_.push("/login")}function h(){i.setSidebarVisibility(!0)}return(m,d)=>{const w=g("router-link"),C=g("BaseIcon"),n=g("BaseDropdownItem"),k=g("BaseDropdown");return o(),p("header",wt,[t(w,{to:"/admin/dashboard",class:"float-none text-lg not-italic font-black tracking-wider text-white brand-main md:float-left font-base hidden md:block"},{default:s(()=>[$t]),_:1}),l("div",{class:N([{"is-active":e(i).isSidebarOpen},"flex float-left p-1 overflow-visible text-sm ease-linear bg-white border-0 rounded cursor-pointer md:hidden md:ml-0 hover:bg-gray-100"]),onClick:ee(h,["prevent"])},[t(C,{name:"MenuIcon",class:"!w-6 !h-6 text-gray-500"})],10,Ct),l("ul",kt,[v?(o(),p("li",St,[t(k,{"width-class":"w-48"},{activator:s(()=>[l("div",Bt,[t(C,{name:"PlusIcon",class:"w-5 h-5 text-gray-600"})])]),default:s(()=>[t(w,{to:"/admin/invoices/create"},{default:s(()=>[e(a).hasAbilities(e(q).CREATE_INVOICE)?(o(),V(n,{key:0},{default:s(()=>[t(C,{name:"DocumentTextIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),M(" "+y(m.$t("invoices.new_invoice")),1)]),_:1})):I("",!0)]),_:1}),t(w,{to:"/admin/estimates/create"},{default:s(()=>[e(a).hasAbilities(e(q).CREATE_ESTIMATE)?(o(),V(n,{key:0},{default:s(()=>[t(C,{name:"DocumentIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),M(" "+y(m.$t("estimates.new_estimate")),1)]),_:1})):I("",!0)]),_:1}),t(w,{to:"/admin/customers/create"},{default:s(()=>[e(a).hasAbilities(e(q).CREATE_CUSTOMER)?(o(),V(n,{key:0},{default:s(()=>[t(C,{name:"UserIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),M(" "+y(m.$t("customers.new_customer")),1)]),_:1})):I("",!0)]),_:1})]),_:1})])):I("",!0),l("li",It,[e(a).currentUser.is_owner||e(a).hasAbilities(e(q).VIEW_CUSTOMER)?(o(),V(xt,{key:0})):I("",!0)]),l("li",null,[t(ot)]),l("li",Vt,[t(k,{"width-class":"w-48"},{activator:s(()=>[l("img",{src:e(u),class:"block w-8 h-8 rounded md:h-9 md:w-9 object-cover"},null,8,Et)]),default:s(()=>[t(w,{to:"/admin/settings/account-settings"},{default:s(()=>[t(n,null,{default:s(()=>[t(C,{name:"CogIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),M(" "+y(m.$t("navigation.settings")),1)]),_:1})]),_:1}),t(n,{onClick:r},{default:s(()=>[t(C,{name:"LogoutIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),M(" "+y(m.$t("navigation.logout")),1)]),_:1})]),_:1})])])])}}},Mt={class:"relative flex flex-col flex-1 w-full max-w-xs bg-white"},At={class:"absolute top-0 right-0 pt-2 -mr-12"},Lt=l("span",{class:"sr-only"},"Close sidebar",-1),Ft={class:"flex-1 h-0 pt-5 pb-4 overflow-y-auto"},Rt={class:"flex items-center shrink-0 px-4 mb-10"},Nt=l("div",{class:"shrink-0 w-14"},null,-1),Tt={class:"hidden w-56 h-screen pb-32 overflow-y-auto bg-white border-r border-gray-200 border-solid xl:w-64 md:fixed md:flex md:flex-col md:inset-y-0 pt-16"},qt={setup(x){const c=K(),a=P();function i(_){return c.path.indexOf(_)>-1}return(_,u)=>{const f=g("BaseIcon"),v=g("router-link");return o(),p(L,null,[t(e(Be),{as:"template",show:e(a).isSidebarOpen},{default:s(()=>[t(e(Ce),{as:"div",class:"fixed inset-0 z-40 flex md:hidden",onClose:u[3]||(u[3]=r=>e(a).setSidebarVisibility(!1))},{default:s(()=>[t(e(Y),{as:"template",enter:"transition-opacity ease-linear duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"transition-opacity ease-linear duration-300","leave-from":"opacity-100","leave-to":"opacity-0"},{default:s(()=>[t(e(ke),{class:"fixed inset-0 bg-gray-600 bg-opacity-75"})]),_:1}),t(e(Y),{as:"template",enter:"transition ease-in-out duration-300","enter-from":"-translate-x-full","enter-to":"translate-x-0",leave:"transition ease-in-out duration-300","leave-from":"translate-x-0","leave-to":"-translate-x-full"},{default:s(()=>[l("div",Mt,[t(e(Y),{as:"template",enter:"ease-in-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in-out duration-300","leave-from":"opacity-100","leave-to":"opacity-0"},{default:s(()=>[l("div",At,[l("button",{class:"flex items-center justify-center w-10 h-10 ml-1 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:u[0]||(u[0]=r=>e(a).setSidebarVisibility(!1))},[Lt,t(f,{name:"XIcon",class:"w-6 h-6 text-white","aria-hidden":"true"})])])]),_:1}),l("div",Ft,[l("div",Rt,[t(Se,{class:"block h-auto max-w-full w-36 text-primary-400",alt:"Crater Logo"})]),(o(!0),p(L,null,T(e(a).menuGroups,r=>(o(),p("nav",{key:r,class:"mt-5 space-y-1"},[(o(!0),p(L,null,T(r,h=>(o(),V(v,{key:h.name,to:h.link,class:N([i(h.link)?"text-primary-500 border-gray-500 bg-gray-100 ":"text-black","cursor-pointer px-0 pl-4 py-3 border-transparent flex items-center border-l-4 border-solid text-sm not-italic font-medium"]),onClick:u[2]||(u[2]=m=>e(a).setSidebarVisibility(!1))},{default:s(()=>[t(f,{name:h.icon,class:N([i(h.link)?"text-primary-500 ":"text-gray-400","mr-4 shrink-0 h-5 w-5"]),onClick:u[1]||(u[1]=m=>e(a).setSidebarVisibility(!1))},null,8,["name","class"]),M(" "+y(_.$t(h.title)),1)]),_:2},1032,["to","class"]))),128))]))),128))])])]),_:1}),Nt]),_:1})]),_:1},8,["show"]),l("div",Tt,[(o(!0),p(L,null,T(e(a).menuGroups,(r,h)=>(o(),p("div",{key:r,class:N(["p-0 m-0 list-none",h==0?"mt-6":""])},[(o(!0),p(L,null,T(r,m=>(o(),V(v,{key:m,to:m.link,class:N([i(m.link)?"text-primary-500 border-gray-500 bg-gray-100 ":"text-black","cursor-pointer px-0 pl-6 hover:bg-gray-50 py-3 group flex items-center border-l-4 border-solid border-transparent text-sm not-italic font-medium"])},{default:s(()=>[t(f,{name:m.icon,class:N([i(m.link)?"text-primary-500 group-hover:text-primary-500 ":"text-gray-400 group-hover:text-black","mr-4 shrink-0 h-5 w-5 "])},null,8,["name","class"]),M(" "+y(_.$t(m.title)),1)]),_:2},1032,["to","class"]))),128))],2))),128))])],64)}}},Ot={class:"font-medium text-lg text-left"},Dt={class:"mt-2 text-sm leading-snug text-gray-500",style:{"max-width":"680px"}},Gt=["onSubmit"],jt={class:"text-gray-500 sm:text-sm"},Pt={class:"text-gray-400 text-xs mt-2 font-light"},zt={slot:"footer",class:"z-0 flex justify-end mt-4 pt-4 border-t border-gray-200 border-solid border-modal-bg"},Wt={emits:["update"],setup(x,{emit:c}){const a=ce();Ie();const i=H(),{t:_,tm:u}=X();let f=B(!1);B(!1);const v={exchange_rate:{required:R.withMessage(_("validation.required"),G),decimal:R.withMessage(_("validation.valid_exchange_rate"),Ve)}},r=le();async function h(){if(r.value.$touch(),r.value.$invalid)return!0;f.value=!0;let m=a.bulkCurrencies.map(w=>({id:w.id,exchange_rate:w.exchange_rate})),d=await a.updateBulkExchangeRate({currencies:m});d.data.success&&c("update",d.data.success),f.value=!1}return(m,d)=>{const w=g("BaseInput"),C=g("BaseInputGroup"),n=g("BaseButton"),k=g("BaseCard");return o(),V(k,null,{default:s(()=>[l("h6",Ot,y(m.$t("settings.exchange_rate.title")),1),l("p",Dt,y(m.$t("settings.exchange_rate.description",{currency:e(i).selectedCompanyCurrency.name})),1),l("form",{action:"",onSubmit:ee(h,["prevent"])},[(o(!0),p(L,null,T(e(a).bulkCurrencies,(E,S)=>(o(),V(e(Le),{key:S,state:E,rules:v},{default:s(({v:A})=>[t(C,{class:"my-5",label:`${E.code} to ${e(i).selectedCompanyCurrency.code}`,error:A.exchange_rate.$error&&A.exchange_rate.$errors[0].$message,required:""},{default:s(()=>[t(w,{modelValue:E.exchange_rate,"onUpdate:modelValue":O=>E.exchange_rate=O,addon:`1 ${E.code} =`,invalid:A.exchange_rate.$error,onInput:O=>A.exchange_rate.$touch()},{right:s(()=>[l("span",jt,y(e(i).selectedCompanyCurrency.code),1)]),_:2},1032,["modelValue","onUpdate:modelValue","addon","invalid","onInput"]),l("span",Pt,y(m.$t("settings.exchange_rate.exchange_help_text",{currency:E.code,baseCurrency:e(i).selectedCompanyCurrency.code})),1)]),_:2},1032,["label","error"])]),_:2},1032,["state"]))),128)),l("div",zt,[t(n,{loading:e(f),variant:"primary",type:"submit"},{default:s(()=>[M(y(m.$t("general.save")),1)]),_:1},8,["loading"])])],40,Gt)]),_:1})}}},Ht={setup(x){const c=J(),a=j(()=>c.active&&c.componentName==="ExchangeRateBulkUpdateModal");function i(){c.closeModal()}return(_,u)=>{const f=g("BaseModal");return o(),V(f,{show:e(a)},{default:s(()=>[t(Wt,{onUpdate:u[0]||(u[0]=v=>i())})]),_:1},8,["show"])}}},Jt={key:0,class:"h-full"},Xt={class:"h-screen h-screen-ios overflow-y-auto md:pl-56 xl:pl-64 min-h-0"},Kt={class:"pt-16 pb-16"},na={setup(x){const c=P(),a=K(),i=te(),_=W(),u=J();X();const f=ce(),v=H(),r=j(()=>c.isAppLoaded);return Ee(()=>{c.bootstrap().then(h=>{a.meta.ability&&!i.hasAbilities(a.meta.ability)?_.push({name:"account.settings"}):a.meta.isOwner&&!i.currentUser.is_owner&&_.push({name:"account.settings"}),h.data.current_company_settings.bulk_exchange_rate_configured==="NO"&&f.fetchBulkCurrencies().then(m=>{if(m.data.currencies.length)u.openModal({componentName:"ExchangeRateBulkUpdateModal",size:"sm"});else{let d={settings:{bulk_exchange_rate_configured:"YES"}};v.updateCompanySettings({data:d})}})})}),(h,m)=>{const d=g("router-view"),w=g("BaseGlobalLoader");return e(r)?(o(),p("div",Jt,[t(Ae),t(Ut),t(qt),t(Ht),l("main",Xt,[l("div",Kt,[t(d)])])])):(o(),V(w,{key:1}))}}};export{na as default};
