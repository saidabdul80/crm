import{aB as fe,a6 as be,u as ge,e as Be,a3 as Ie,g as h,f as ye,K as he,F as ke,l as N,a7 as Ee,a8 as Ce,r as o,o as b,n as g,w as l,a,aa as T,ab as $,m as n,H as k,q as m,t as _,O as f,I as w,a4 as G,b as p,p as Ve}from"./main-4279fdc3.js";import{_ as De}from"./MoonwalkerIcon-60430dd9.js";import{_ as Te}from"./InvoiceIndexDropdown-959ec0b8.js";import{_ as $e}from"./SendInvoiceModal-5fc69574.js";import"./mail-driver-cd954e0c.js";const Ae=p("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1),Se={class:"relative table-container"},Pe={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Fe={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Ne={class:"absolute items-center left-6 top-2.5 select-none"},we={class:"relative block"},Ue={class:"px-3"},Oe={class:"flex justify-between"},He={setup(Re){const c=fe(),H=be();ge();const{t:i}=Be();Ie("$utils");const E=h(null),B=h(!1),j=h([{label:"Status",options:["DRAFT","DUE","SENT","VIEWED","COMPLETED"]},{label:"Paid Status",options:["UNPAID","PAID","PARTIALLY_PAID"]},,]),C=h(!0),u=h("general.draft");ye();const V=he();let s=ke({customer_id:"",status:"",from_date:"",to_date:"",invoice_number:""});const U=N(()=>!c.invoiceTotalCount&&!C.value),A=N({get:()=>c.selectedInvoices,set:t=>c.selectInvoice(t)}),q=N(()=>[{key:"checkbox",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"invoice_date",label:i("invoices.date"),thClass:"extra",tdClass:"font-medium"},{key:"invoice_number",label:i("invoices.number")},{key:"name",label:i("invoices.customer")},{key:"total",label:i("invoices.total"),tdClass:"font-medium text-gray-900"},{key:"to_amount",label:i("invoices.to_total")},{key:"actions",label:i("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);Ee(s,()=>{Q()},{debounce:500}),Ce(()=>{c.selectAllField&&c.selectAllInvoices()});function z(){return V.hasAbilities([f.DELETE_INVOICE,f.EDIT_INVOICE,f.VIEW_INVOICE,f.SEND_INVOICE])}async function Y(t,r){s.status="",S()}function S(){E.value&&E.value.refresh()}function K(t){C.value=t}async function X({page:t,filter:r,sort:v}){let P={customer_id:s.customer_id,status:s.status,from_date:s.from_date,to_date:s.to_date,invoice_number:s.invoice_number,orderByField:v.fieldName||"created_at",orderBy:v.order||"desc",page:t};C.value=!0;let d=await c.fetchInvoices(P);return C.value=!1,{data:d.data.data,pagination:{totalPages:d.data.meta.last_page,currentPage:t,totalCount:d.data.meta.total,limit:10}}}function J(t){if(u.value==t.title)return!0;switch(u.value=t.title,t.title){case i("general.draft"):s.status="DRAFT";break;case i("general.sent"):s.status="SENT";break;case i("general.due"):s.status="DUE";break;default:s.status="";break}}function Q(){c.$patch(t=>{t.selectedInvoices=[],t.selectAllField=!1}),S()}function O(){s.customer_id="",s.status="",s.from_date="",s.to_date="",s.invoice_number="",u.value=i("general.all")}async function Z(){H.openDialog({title:i("general.are_you_sure"),message:i("invoices.confirm_delete"),yesLabel:i("general.ok"),noLabel:i("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async t=>{t&&await c.deleteMultipleInvoices().then(r=>{r.data.success&&(S(),c.$patch(v=>{v.selectedInvoices=[],v.selectAllField=!1}))})})}function ee(){B.value&&O(),B.value=!B.value}function te(t){switch(t){case"DRAFT":u.value=i("general.draft");break;case"SENT":u.value=i("general.sent");break;case"DUE":u.value=i("general.due");break;case"COMPLETED":u.value=i("invoices.completed");break;case"PAID":u.value=i("invoices.paid");break;case"UNPAID":u.value=i("invoices.unpaid");break;case"PARTIALLY_PAID":u.value=i("invoices.partially_paid");break;case"VIEWED":u.value=i("invoices.viewed");break;default:u.value=i("general.all");break}}return(t,r)=>{const v=o("BaseBreadcrumbItem"),P=o("BaseBreadcrumb"),d=o("BaseIcon"),F=o("BaseButton"),R=o("router-link"),ae=o("BasePageHeader"),le=o("BaseCustomerSelectInput"),I=o("BaseInputGroup"),se=o("BaseMultiselect"),L=o("BaseDatePicker"),ne=o("BaseInput"),oe=o("BaseFilterWrapper"),ie=o("BaseEmptyPlaceholder"),D=o("BaseTab"),re=o("BaseTabGroup"),ce=o("BaseDropdownItem"),ue=o("BaseDropdown"),x=o("BaseCheckbox"),de=o("BaseText"),M=o("BaseFormatMoney"),W=o("BasePaidStatusBadge"),me=o("BaseInvoiceStatusBadge"),_e=o("BaseTable"),ve=o("BasePage");return b(),g(ve,null,{default:l(()=>[a($e),a(ae,{title:t.$t("invoices.title")},{actions:l(()=>[T(a(F,{variant:"primary-outline",onClick:ee},{right:l(e=>[B.value?(b(),g(d,{key:1,name:"XIcon",class:k(e.class)},null,8,["class"])):(b(),g(d,{key:0,name:"FilterIcon",class:k(e.class)},null,8,["class"]))]),default:l(()=>[m(_(t.$t("general.filter"))+" ",1)]),_:1},512),[[$,n(c).invoiceTotalCount]]),n(V).hasAbilities(n(f).CREATE_INVOICE)?(b(),g(R,{key:0,to:"invoices/create"},{default:l(()=>[a(F,{variant:"primary",class:"ml-4"},{left:l(e=>[a(d,{name:"PlusIcon",class:k(e.class)},null,8,["class"])]),default:l(()=>[m(" "+_(t.$t("invoices.new_invoice")),1)]),_:1})]),_:1})):w("",!0)]),default:l(()=>[a(P,null,{default:l(()=>[a(v,{title:t.$t("general.home"),to:"dashboard"},null,8,["title"]),a(v,{title:t.$t("invoices.invoice",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),T(a(oe,{"row-on-xl":!0,onClear:O},{default:l(()=>[a(I,{label:t.$t("customers.customer",1)},{default:l(()=>[a(le,{modelValue:n(s).customer_id,"onUpdate:modelValue":r[0]||(r[0]=e=>n(s).customer_id=e),placeholder:t.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(I,{label:t.$t("invoices.status")},{default:l(()=>[a(se,{modelValue:n(s).status,"onUpdate:modelValue":[r[1]||(r[1]=e=>n(s).status=e),te],groups:!0,options:j.value,searchable:"",placeholder:t.$t("general.select_a_status"),onRemove:r[2]||(r[2]=e=>Y())},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),a(I,{label:t.$t("general.from")},{default:l(()=>[a(L,{modelValue:n(s).from_date,"onUpdate:modelValue":r[3]||(r[3]=e=>n(s).from_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),Ae,a(I,{label:t.$t("general.to"),class:"mt-2"},{default:l(()=>[a(L,{modelValue:n(s).to_date,"onUpdate:modelValue":r[4]||(r[4]=e=>n(s).to_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),a(I,{label:t.$t("invoices.invoice_number")},{default:l(()=>[a(ne,{modelValue:n(s).invoice_number,"onUpdate:modelValue":r[5]||(r[5]=e=>n(s).invoice_number=e)},{left:l(e=>[a(d,{name:"HashtagIcon",class:k(e.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},512),[[$,B.value]]),T(a(ie,{title:t.$t("invoices.no_invoices"),description:t.$t("invoices.list_of_invoices")},G({default:l(()=>[a(De,{class:"mt-5 mb-4"})]),_:2},[n(V).hasAbilities(n(f).CREATE_INVOICE)?{name:"actions",fn:l(()=>[a(F,{variant:"primary-outline",onClick:r[6]||(r[6]=e=>t.$router.push("/admin/invoices/create"))},{left:l(e=>[a(d,{name:"PlusIcon",class:k(e.class)},null,8,["class"])]),default:l(()=>[m(" "+_(t.$t("invoices.add_new_invoice")),1)]),_:1})])}:void 0]),1032,["title","description"]),[[$,n(U)]]),T(p("div",Se,[p("div",Pe,[a(re,{class:"-mb-5",onChange:J},{default:l(()=>[a(D,{title:t.$t("general.all"),filter:""},null,8,["title"]),a(D,{title:t.$t("general.draft"),filter:"DRAFT"},null,8,["title"]),a(D,{title:t.$t("general.sent"),filter:"SENT"},null,8,["title"]),a(D,{title:t.$t("general.due"),filter:"DUE"},null,8,["title"])]),_:1}),n(c).selectedInvoices.length&&n(V).hasAbilities(n(f).DELETE_INVOICE)?(b(),g(ue,{key:0,class:"absolute float-right"},{activator:l(()=>[p("span",Fe,[m(_(t.$t("general.actions"))+" ",1),a(d,{name:"ChevronDownIcon"})])]),default:l(()=>[a(ce,{onClick:Z},{default:l(()=>[a(d,{name:"TrashIcon",class:"mr-3 text-gray-600"}),m(" "+_(t.$t("general.delete")),1)]),_:1})]),_:1})):w("",!0)]),a(_e,{ref:(e,y)=>{y.table=e,E.value=e},data:X,columns:n(q),"placeholder-count":n(c).invoiceTotalCount>=20?10:5,class:"mt-10"},G({header:l(()=>[p("div",Ne,[a(x,{modelValue:n(c).selectAllField,"onUpdate:modelValue":r[7]||(r[7]=e=>n(c).selectAllField=e),variant:"primary",onChange:n(c).selectAllInvoices},null,8,["modelValue","onChange"])])]),"cell-checkbox":l(({row:e})=>[p("div",we,[a(x,{id:e.id,modelValue:n(A),"onUpdate:modelValue":r[8]||(r[8]=y=>Ve(A)?A.value=y:null),value:e.data.id},null,8,["id","modelValue","value"])])]),"cell-name":l(({row:e})=>[a(de,{text:e.data.customer.name,length:30},null,8,["text"])]),"cell-invoice_number":l(({row:e})=>[a(R,{to:{path:`invoices/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:l(()=>[m(_(e.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-invoice_date":l(({row:e})=>[m(_(e.data.formatted_invoice_date),1)]),"cell-total":l(({row:e})=>[a(M,{amount:e.data.total,currency:e.data.from_currency},null,8,["amount","currency"]),a(W,{status:e.data.paid_status,class:"px-1 py-0.5 ml-2"},{default:l(()=>[m(_(e.data.paid_status),1)]),_:2},1032,["status"])]),"cell-to_amount":l(({row:e})=>[p("span",Ue,[a(M,{amount:e.data.items.reduce((y,pe)=>y+pe.quantity,0),currency:e.data.currency},null,8,["amount","currency"])]),a(me,{status:e.data.status,class:"px-3 py-1"},{default:l(()=>[m(_(e.data.status),1)]),_:2},1032,["status"])]),"cell-due_amount":l(({row:e})=>[p("div",Oe,[e.data.overdue?(b(),g(W,{key:0,status:"OVERDUE",class:"px-1 py-0.5 ml-2"},{default:l(()=>[m(_(t.$t("invoices.overdue")),1)]),_:1})):w("",!0)])]),_:2},[z()?{name:"cell-actions",fn:l(({row:e})=>[a(Te,{onLoading:K,row:e.data,table:E.value},null,8,["row","table"])])}:void 0]),1032,["columns","placeholder-count"])],512),[[$,!n(U)]])]),_:1})}}};export{He as default};
