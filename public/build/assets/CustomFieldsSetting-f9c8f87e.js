import{a6 as re,u as ne,e as G,ar as K,J as ue,K as ee,D as J,a3 as te,r as i,o as C,n as F,w as n,a as s,m as e,O as L,q as D,t as w,I as A,g as U,c as j,aH as ie,s as le,F as W,l as B,aI as de,aJ as g,h as q,i as k,aC as me,k as ce,b as O,p as Z,M as pe,H as z,L as _e,a1 as fe,a4 as ve}from"./main-9a914193.js";import{_ as Ce}from"./dynamic-import-helper-be004503.js";const ye={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(M){const p=M,t=re();ne();const{t:u}=G(),v=K();ue();const _=ee(),d=J();te("utils");async function m(y){await v.fetchCustomField(y),d.openModal({title:u("settings.custom_fields.edit_custom_field"),componentName:"CustomFieldModal",size:"sm",data:y,refreshData:p.loadData})}async function h(y){t.openDialog({title:u("general.are_you_sure"),message:u("settings.custom_fields.custom_field_confirm_delete"),yesLabel:u("general.ok"),noLabel:u("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async b=>{b&&(await v.deleteCustomFields(y),p.loadData&&p.loadData())})}return(y,b)=>{const f=i("BaseIcon"),T=i("BaseDropdownItem"),I=i("BaseDropdown");return C(),F(I,null,{activator:n(()=>[s(f,{name:"DotsHorizontalIcon",class:"h-5 text-gray-500"})]),default:n(()=>[e(_).hasAbilities(e(L).EDIT_CUSTOM_FIELDS)?(C(),F(T,{key:0,onClick:b[0]||(b[0]=o=>m(M.row.id))},{default:n(()=>[s(f,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),D(" "+w(y.$t("general.edit")),1)]),_:1})):A("",!0),e(_).hasAbilities(e(L).DELETE_CUSTOM_FIELDS)?(C(),F(T,{key:1,onClick:b[1]||(b[1]=o=>h(M.row.id))},{default:n(()=>[s(f,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),D(" "+w(y.$t("general.delete")),1)]),_:1})):A("",!0)]),_:1})}}},be={class:"flex items-center mt-1"},ge={emits:["onAdd"],setup(M,{emit:p}){const t=U(null);function u(){if(t.value==null||t.value==""||t.value==null)return!0;p("onAdd",t.value),t.value=null}return(v,_)=>{const d=i("BaseInput"),m=i("BaseIcon");return C(),j("div",be,[s(d,{modelValue:t.value,"onUpdate:modelValue":_[0]||(_[0]=h=>t.value=h),type:"text",class:"w-full md:w-96",placeholder:v.$t("settings.custom_fields.press_enter_to_add"),onClick:u,onKeydown:ie(le(u,["prevent","stop"]),["enter"])},null,8,["modelValue","placeholder","onKeydown"]),s(m,{name:"PlusCircleIcon",class:"ml-1 text-primary-500 cursor-pointer",onClick:u})])}}},Fe={class:"flex justify-between w-full"},$e=["onSubmit"],we={class:"overflow-y-auto max-h-[550px]"},Te={class:"px-4 md:px-8 py-8 overflow-y-auto sm:p-6"},Ie={class:"z-0 flex justify-end p-4 border-t border-solid border-gray-light border-modal-bg"},Be={setup(M){const p=J(),t=K(),{t:u}=G();let v=U(!1);const _=W(["Customer","Invoice","Estimate","Expense","Payment"]),d=W([{label:"Text",value:"Input"},{label:"Textarea",value:"TextArea"},{label:"Phone",value:"Phone"},{label:"URL",value:"Url"},{label:"Number",value:"Number"},{label:"Select Field",value:"Dropdown"},{label:"Switch Toggle",value:"Switch"},{label:"Date",value:"Date"},{label:"Time",value:"Time"},{label:"Date & Time",value:"DateTime"}]);let m=U(d[0]);const h=B(()=>p.active&&p.componentName==="CustomFieldModal"),y=B(()=>m.value&&m.value.label==="Switch Toggle"),b=B(()=>m.value&&m.value.label==="Select Field"),f=B(()=>t.currentCustomField.type?de(()=>Ce(Object.assign({"../../custom-fields/types/DateTimeType.vue":()=>g(()=>import("./DateTimeType-a00b12ef.js"),["assets/DateTimeType-a00b12ef.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/DateType.vue":()=>g(()=>import("./DateType-24d2e50a.js"),["assets/DateType-24d2e50a.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/DropdownType.vue":()=>g(()=>import("./DropdownType-047f656e.js"),["assets/DropdownType-047f656e.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/InputType.vue":()=>g(()=>import("./InputType-6278a9cc.js"),["assets/InputType-6278a9cc.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/NumberType.vue":()=>g(()=>import("./NumberType-cbbf3ff8.js"),["assets/NumberType-cbbf3ff8.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/PhoneType.vue":()=>g(()=>import("./PhoneType-85aeaa66.js"),["assets/PhoneType-85aeaa66.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/SwitchType.vue":()=>g(()=>import("./SwitchType-1767cd80.js"),["assets/SwitchType-1767cd80.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/TextAreaType.vue":()=>g(()=>import("./TextAreaType-847d45d3.js"),["assets/TextAreaType-847d45d3.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/TimeType.vue":()=>g(()=>import("./TimeType-f63b0433.js"),["assets/TimeType-f63b0433.js","assets/main-9a914193.js","assets/main-60ce83b2.css"]),"../../custom-fields/types/UrlType.vue":()=>g(()=>import("./UrlType-df9aaea0.js"),["assets/UrlType-df9aaea0.js","assets/main-9a914193.js","assets/main-60ce83b2.css"])}),`../../custom-fields/types/${t.currentCustomField.type}Type.vue`)):!1),T=B({get:()=>t.currentCustomField.is_required===1,set:l=>{const a=l?1:0;t.currentCustomField.is_required=a}}),I=B(()=>({currentCustomField:{type:{required:q.withMessage(u("validation.required"),k)},name:{required:q.withMessage(u("validation.required"),k)},label:{required:q.withMessage(u("validation.required"),k)},model_type:{required:q.withMessage(u("validation.required"),k)},order:{required:q.withMessage(u("validation.required"),k),numeric:q.withMessage(u("validation.numbers_only"),me)},type:{required:q.withMessage(u("validation.required"),k)}}})),o=ce(I,B(()=>t));function V(){t.isEdit?m.value=d.find(l=>l.value==t.currentCustomField.type):(t.currentCustomField.model_type=_[0],t.currentCustomField.type=d[0].value,m.value=d[0])}async function x(){if(o.value.currentCustomField.$touch(),o.value.currentCustomField.$invalid)return!0;v.value=!0;let l={...t.currentCustomField};if(t.currentCustomField.options&&(l.options=t.currentCustomField.options.map(S=>S.name)),l.type=="Time"&&typeof l.default_answer=="object"){let S=l&&l.default_answer&&l.default_answer.HH?l.default_answer.HH:null,E=l&&l.default_answer&&l.default_answer.mm?l.default_answer.mm:null;l&&l.default_answer&&l.default_answer.ss&&l.default_answer.ss,l.default_answer=`${S}:${E}`}await(t.isEdit?t.updateCustomField:t.addCustomField)(l),v.value=!1,p.refreshData&&p.refreshData(),H()}function N(l){t.currentCustomField.options=[{name:l},...t.currentCustomField.options]}function c(l){if(t.isEdit&&t.currentCustomField.in_use)return;t.currentCustomField.options[l].name===t.currentCustomField.default_answer&&(t.currentCustomField.default_answer=null),t.currentCustomField.options.splice(l,1)}function R(l){t.currentCustomField.type=l.value}function H(){p.closeModal(),setTimeout(()=>{t.resetCurrentCustomField(),o.value.$reset()},300)}return(l,a)=>{const S=i("BaseIcon"),E=i("BaseInput"),$=i("BaseInputGroup"),Y=i("BaseMultiselect"),se=i("BaseSwitch"),oe=i("BaseInputGrid"),X=i("BaseButton"),ae=i("BaseModal");return C(),F(ae,{show:e(h),onOpen:V},{header:n(()=>[O("div",Fe,[D(w(e(p).title)+" ",1),s(S,{name:"XIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:H})])]),default:n(()=>[O("form",{action:"",onSubmit:le(x,["prevent"])},[O("div",we,[O("div",Te,[s(oe,{layout:"one-column"},{default:n(()=>[s($,{label:l.$t("settings.custom_fields.name"),required:"",error:e(o).currentCustomField.name.$error&&e(o).currentCustomField.name.$errors[0].$message},{default:n(()=>[s(E,{ref:(r,P)=>{P.name=r},modelValue:e(t).currentCustomField.name,"onUpdate:modelValue":a[0]||(a[0]=r=>e(t).currentCustomField.name=r),invalid:e(o).currentCustomField.name.$error,onInput:a[1]||(a[1]=r=>e(o).currentCustomField.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),s($,{label:l.$t("settings.custom_fields.model"),error:e(o).currentCustomField.model_type.$error&&e(o).currentCustomField.model_type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?l.$t("settings.custom_fields.model_in_use"):"",required:""},{default:n(()=>[s(Y,{modelValue:e(t).currentCustomField.model_type,"onUpdate:modelValue":a[2]||(a[2]=r=>e(t).currentCustomField.model_type=r),options:e(_),"can-deselect":!1,invalid:e(o).currentCustomField.model_type.$error,searchable:!0,disabled:e(t).currentCustomField.in_use,onInput:a[3]||(a[3]=r=>e(o).currentCustomField.model_type.$touch())},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),s($,{class:"flex items-center space-x-4",label:l.$t("settings.custom_fields.required")},{default:n(()=>[s(se,{modelValue:e(T),"onUpdate:modelValue":a[4]||(a[4]=r=>Z(T)?T.value=r:null)},null,8,["modelValue"])]),_:1},8,["label"]),s($,{label:l.$t("settings.custom_fields.type"),error:e(o).currentCustomField.type.$error&&e(o).currentCustomField.type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?l.$t("settings.custom_fields.type_in_use"):"",required:""},{default:n(()=>[s(Y,{modelValue:e(m),"onUpdate:modelValue":[a[5]||(a[5]=r=>Z(m)?m.value=r:m=r),R],options:e(d),invalid:e(o).currentCustomField.type.$error,disabled:e(t).currentCustomField.in_use,searchable:!0,"can-deselect":!1,object:""},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),s($,{label:l.$t("settings.custom_fields.label"),required:"",error:e(o).currentCustomField.label.$error&&e(o).currentCustomField.label.$errors[0].$message},{default:n(()=>[s(E,{modelValue:e(t).currentCustomField.label,"onUpdate:modelValue":a[6]||(a[6]=r=>e(t).currentCustomField.label=r),invalid:e(o).currentCustomField.label.$error,onInput:a[7]||(a[7]=r=>e(o).currentCustomField.label.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),e(b)?(C(),F($,{key:0,label:l.$t("settings.custom_fields.options")},{default:n(()=>[s(ge,{onOnAdd:N}),(C(!0),j(_e,null,pe(e(t).currentCustomField.options,(r,P)=>(C(),j("div",{key:P,class:"flex items-center mt-5"},[s(E,{modelValue:r.name,"onUpdate:modelValue":Q=>r.name=Q,class:"w-64"},null,8,["modelValue","onUpdate:modelValue"]),s(S,{name:"MinusCircleIcon",class:z(["ml-1 cursor-pointer",e(t).currentCustomField.in_use?"text-gray-300":"text-red-300"]),onClick:Q=>c(P)},null,8,["class","onClick"])]))),128))]),_:1},8,["label"])):A("",!0),s($,{label:l.$t("settings.custom_fields.default_value"),class:"relative"},{default:n(()=>[(C(),F(fe(e(f)),{modelValue:e(t).currentCustomField.default_answer,"onUpdate:modelValue":a[8]||(a[8]=r=>e(t).currentCustomField.default_answer=r),options:e(t).currentCustomField.options,"default-date-time":e(t).currentCustomField.dateTimeValue},null,8,["modelValue","options","default-date-time"]))]),_:1},8,["label"]),e(y)?A("",!0):(C(),F($,{key:1,label:l.$t("settings.custom_fields.placeholder")},{default:n(()=>[s(E,{modelValue:e(t).currentCustomField.placeholder,"onUpdate:modelValue":a[9]||(a[9]=r=>e(t).currentCustomField.placeholder=r)},null,8,["modelValue"])]),_:1},8,["label"])),s($,{label:l.$t("settings.custom_fields.order"),error:e(o).currentCustomField.order.$error&&e(o).currentCustomField.order.$errors[0].$message,required:""},{default:n(()=>[s(E,{modelValue:e(t).currentCustomField.order,"onUpdate:modelValue":a[10]||(a[10]=r=>e(t).currentCustomField.order=r),type:"number",invalid:e(o).currentCustomField.order.$error,onInput:a[11]||(a[11]=r=>e(o).currentCustomField.order.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})])]),O("div",Ie,[s(X,{class:"mr-3",type:"button",variant:"primary-outline",onClick:H},{default:n(()=>[D(w(l.$t("general.cancel")),1)]),_:1}),s(X,{variant:"primary",loading:e(v),disabled:e(v),type:"submit"},{left:n(r=>[e(v)?A("",!0):(C(),F(S,{key:0,class:z(r.class),name:"SaveIcon"},null,8,["class"]))]),default:n(()=>[D(" "+w(e(t).isEdit?l.$t("general.update"):l.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,$e)]),_:1},8,["show"])}}},De={class:"text-xs text-gray-500"},Se={setup(M){const p=J(),t=K(),u=ee(),v=te("utils"),{t:_}=G(),d=U(null),m=B(()=>[{key:"name",label:_("settings.custom_fields.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"model_type",label:_("settings.custom_fields.model")},{key:"type",label:_("settings.custom_fields.type")},{key:"is_required",label:_("settings.custom_fields.required")},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);async function h({page:f,filter:T,sort:I}){let o={orderByField:I.fieldName||"created_at",orderBy:I.order||"desc",page:f},V=await t.fetchCustomFields(o);return{data:V.data.data,pagination:{totalPages:V.data.meta.last_page,currentPage:f,limit:5,totalCount:V.data.meta.total}}}function y(){p.openModal({title:_("settings.custom_fields.add_custom_field"),componentName:"CustomFieldModal",size:"sm",refreshData:d.value&&d.value.refresh})}async function b(){d.value&&d.value.refresh()}return(f,T)=>{const I=i("BaseIcon"),o=i("BaseButton"),V=i("BaseBadge"),x=i("BaseTable"),N=i("BaseSettingCard");return C(),F(N,{title:f.$t("settings.menu_title.custom_fields"),description:f.$t("settings.custom_fields.section_description")},{action:n(()=>[e(u).hasAbilities(e(L).CREATE_CUSTOM_FIELDS)?(C(),F(o,{key:0,variant:"primary-outline",onClick:y},{left:n(c=>[s(I,{class:z(c.class),name:"PlusIcon"},null,8,["class"]),D(" "+w(f.$t("settings.custom_fields.add_custom_field")),1)]),_:1})):A("",!0)]),default:n(()=>[s(Be),s(x,{ref:(c,R)=>{R.table=c,d.value=c},data:h,columns:e(m),class:"mt-16"},ve({"cell-name":n(({row:c})=>[D(w(c.data.name)+" ",1),O("span",De," ("+w(c.data.slug)+")",1)]),"cell-is_required":n(({row:c})=>[s(V,{"bg-color":e(v).getBadgeStatusColor(c.data.is_required?"YES":"NO").bgColor,color:e(v).getBadgeStatusColor(c.data.is_required?"YES":"NO").color},{default:n(()=>[D(w(c.data.is_required?f.$t("settings.custom_fields.yes"):f.$t("settings.custom_fields.no").replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),_:2},[e(u).hasAbilities([e(L).DELETE_CUSTOM_FIELDS,e(L).EDIT_CUSTOM_FIELDS])?{name:"cell-actions",fn:n(({row:c})=>[s(ye,{row:c.data,table:d.value,"load-data":b},null,8,["row","table"])])}:void 0]),1032,["columns"])]),_:1},8,["title","description"])}}};export{Se as default};
