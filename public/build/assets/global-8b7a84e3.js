import{h as i}from"./auth-c8165e3e.js";import{v as n,u as c}from"./main-4279fdc3.js";const u={name:null,phone:null,address_street_1:null,address_street_2:null,city:null,state:null,country_id:null,zip:null,type:null},{defineStore:d}=window.pinia,m=d({id:"customerUserStore",state:()=>({customers:[],userForm:{avatar:null,name:"",email:"",password:"",company:"",confirm_password:"",billing:{...u},shipping:{...u}}}),actions:{copyAddress(){this.userForm.shipping={...this.userForm.billing,type:"shipping"}},fetchCurrentUser(){const t=l();return new Promise((r,e)=>{n.get(`/api/v1/${t.companySlug}/customer/me`).then(o=>{Object.assign(this.userForm,o.data.data),r(o)}).catch(o=>{i(o),e(o)})})},updateCurrentUser({data:t,message:r}){const e=l();return new Promise((o,a)=>{n.post(`/api/v1/${e.companySlug}/customer/profile`,t).then(s=>{this.userForm=s.data.data,e.currentUser=s.data.data,o(s),r&&c(!0).showNotification({type:"success",message:r})}).catch(s=>{i(s),a(s)})})}}}),{defineStore:h}=window.pinia;n.interceptors.request.use(t=>(t.headers.Authorization=`Bearer ${localStorage.getItem("auth.token")}`,t));const l=h({id:"CustomerPortalGlobalStore",state:()=>({languages:[],currency:null,isAppLoaded:!1,countries:[],getDashboardDataLoaded:!1,currentUser:null,companySlug:"",mainMenu:null,enabledModules:[]}),actions:{bootstrap(t){this.companySlug=t;const r=m();return new Promise((e,o)=>{n.get(`/api/v1/${t}/customer/bootstrap`).then(a=>{this.currentUser=a.data.data,this.mainMenu=a.data.meta.menu,this.currency=a.data.data.currency,this.enabledModules=a.data.meta.modules,Object.assign(r.userForm,a.data.data),window.i18n.locale=a.data.default_language,this.isAppLoaded=!0,e(a)}).catch(a=>{i(a),o(a)})})},fetchCountries(){return new Promise((t,r)=>{this.countries.length?t(this.countries):n.get(`/api/v1/${this.companySlug}/customer/countries`).then(e=>{this.countries=e.data.data,t(e)}).catch(e=>{i(e),r(e)})})}}});export{m as a,l as u};
