import{a2 as f,v as a,$ as o,u as r}from"./main-9a914193.js";const g=(k=!1)=>{const h=k?window.pinia.defineStore:f,{global:n}=window.i18n;return a.interceptors.request.use(t=>(t.headers.Authorization=`Bearer ${localStorage.getItem("auth.token")}`,t)),h({id:"disk",state:()=>({disks:[],diskDrivers:[],diskConfigData:null,selected_driver:"local",doSpaceDiskConfig:{name:"",selected_driver:"doSpaces",key:"",secret:"",region:"",bucket:"",endpoint:"",root:""},dropBoxDiskConfig:{name:"",selected_driver:"dropbox",token:"",key:"",secret:"",app:""},localDiskConfig:{name:"",selected_driver:"local",root:""},s3DiskConfigData:{name:"",selected_driver:"s3",key:"",secret:"",region:"",bucket:"",root:""}}),getters:{getDiskDrivers:t=>t.diskDrivers},actions:{fetchDiskEnv(t){return new Promise((s,i)=>{a.get(`/api/v1/disks/${t.disk}`).then(e=>{s(e)}).catch(e=>{o(e),i(e)})})},fetchDisks(t){return new Promise((s,i)=>{a.get("/api/v1/disks",{params:t}).then(e=>{this.disks=e.data.data,s(e)}).catch(e=>{o(e),i(e)})})},fetchDiskDrivers(){return new Promise((t,s)=>{a.get("/api/v1/disk/drivers").then(i=>{this.diskConfigData=i.data,this.diskDrivers=i.data.drivers,t(i)}).catch(i=>{o(i),s(i)})})},deleteFileDisk(t){return new Promise((s,i)=>{a.delete(`/api/v1/disks/${t}`).then(e=>{if(e.data.success){let d=this.disks.findIndex(c=>c.id===t);this.disks.splice(d,1),r().showNotification({type:"success",message:n.t("settings.disk.deleted_message")})}s(e)}).catch(e=>{o(e),i(e)})})},updateDisk(t){return new Promise((s,i)=>{a.put(`/api/v1/disks/${t.id}`,t).then(e=>{if(e.data){let d=this.disks.findIndex(c=>c.id===e.data.data);this.disks[d]=t.disks,r().showNotification({type:"success",message:n.t("settings.disk.success_set_default_disk")})}s(e)}).catch(e=>{o(e),i(e)})})},createDisk(t){return new Promise((s,i)=>{a.post("/api/v1/disks",t).then(e=>{e.data&&r().showNotification({type:"success",message:n.t("settings.disk.success_create")}),this.disks.push(e.data),s(e)}).catch(e=>{o(e),i(e)})})}}})()};export{g as u};
