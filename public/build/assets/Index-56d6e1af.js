import{D as Q,a5 as Z,u as de,e as ee,g as B,l as S,h as R,i as W,G as pe,k as _e,r as l,o as y,n as C,w as t,b as i,q as p,t as d,m as o,a,H as g,s as fe,C as ye,a6 as he,K as ve,F as Ce,a7 as ge,a8 as be,a9 as Be,c as $e,aa as Y,ab as H,O as b,I as A,p as X,a4 as Ie,L as ke}from"./main-9a914193.js";import{_ as we}from"./CustomerIndexDropdown-d3aaeecf.js";import{_ as Se}from"./AstronautIcon-be2e2ced.js";const xe={class:"flex justify-between w-full"},Me=p(" Download Template "),Ee=["onSubmit"],Te={class:"px-8 py-8 sm:p-6"},Fe={class:"flex justify-end px-4 py-4 border-t border-solid border-gray-light"},Ve=p(" Upload "),De={emits:["uploaded"],setup(te,{emit:P}){const r=Q(),h=Z();de();const{t:$}=ee(),_=B(!1);B(["customer","customerCustom"]);const v=B(null),x=S(()=>r.active&&r.componentName==="ImportCustomerModal"),m=S(()=>({currentFile:{name:{required:R.withMessage($("validation.required"),W),minLength:R.withMessage($("validation.name_min_length",{count:3}),pe(3))},notes:{required:R.withMessage($("validation.required"),W)},type:{required:R.withMessage($("validation.required"),W)}}})),u=_e(m);function I(){r.closeModal(),setTimeout(()=>{u.value.$reset()},300)}async function M(){await h.downloadTemplate()}async function E(){_.value=!0,await h.uploadCustomer(v.value),_.value=!1,P("uploaded",!0),r.active=!1}function q(f){const k=f.target.files[0];v.value=k}return(f,k)=>{const T=l("BaseIcon"),F=l("BaseButton"),U=l("BaseInputGroup"),O=l("BaseInputGrid"),N=l("BaseModal");return y(),C(N,{show:o(x),onClose:I},{header:t(()=>[i("div",xe,[p(d(o(r).title)+" ",1),a(F,{variant:"primary",type:"button",onClick:k[0]||(k[0]=w=>M())},{left:t(({classname:w})=>[a(T,{name:"SaveIcon",class:g(w)},null,8,["class"])]),default:t(()=>[Me]),_:1}),a(T,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:I})])]),default:t(()=>[i("form",{onSubmit:fe(E,["prevent"])},[i("div",Te,[a(O,{layout:"one-column"},{default:t(()=>[a(U,{label:f.$t("Upload File")},{default:t(()=>[i("input",{type:"file",onChange:q,accept:".csv, .xls, .xlsx",required:""},null,32)]),_:1},8,["label"])]),_:1})]),i("div",Fe,[a(F,{class:"mr-2",variant:"primary-outline",type:"button",onClick:I},{default:t(()=>[p(d(f.$t("general.cancel")),1)]),_:1}),a(F,{loading:_.value,disabled:_.value,variant:"primary",type:"submit"},{left:t(({classname:w})=>[a(T,{name:"SaveIcon",class:g(w)},null,8,["class"])]),default:t(()=>[Ve]),_:1},8,["loading","disabled"])])],40,Ee)]),_:1},8,["show"])}}},Ae={class:"flex items-center justify-end space-x-5"},Ue={class:"relative table-container"},Ne={class:"relative flex items-center justify-end h-5"},Re={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Pe={class:"absolute z-10 items-center left-6 top-2.5 select-none"},qe={class:"relative block"},je={setup(te){ye();const P=he(),r=Z(),h=ve(),$=Q();let _=B(null),v=B(!1),x=B(!0);const{t:m}=ee();let u=Ce({display_name:"",contact_name:"",phone:""});const I=S(()=>!r.totalCustomers&&!x.value),M=S({get:()=>r.selectedCustomers,set:s=>r.selectCustomer(s)}),E=S({get:()=>r.selectAllField,set:s=>r.setSelectAllState(s)}),q=S(()=>[{key:"status",thClass:"extra w-10 pr-0",sortable:!1,tdClass:"font-medium text-gray-900 pr-0"},{key:"name",label:m("customers.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"phone",label:m("customers.phone")},{key:"due_amount",label:m("customers.amount_due")},{key:"created_at",label:m("items.added_on")},{key:"actions",tdClass:"text-right text-sm font-medium pl-0",thClass:"pl-0",sortable:!1}]);ge(u,()=>{k()},{debounce:500}),be(()=>{r.selectAllField&&r.selectAllCustomers()});function f(){_.value.refresh()}function k(){f()}function T(){return h.hasAbilities([b.DELETE_CUSTOMER,b.EDIT_CUSTOMER,b.VIEW_CUSTOMER])}async function F({page:s,filter:n,sort:V}){let G={display_name:u.display_name,contact_name:u.contact_name,phone:u.phone,orderByField:V.fieldName||"created_at",orderBy:V.order||"desc",page:s};x.value=!0;let c=await r.fetchCustomers(G);return x.value=!1,{data:c.data.data,pagination:{totalPages:c.data.meta.last_page,currentPage:s,totalCount:c.data.meta.total,limit:10}}}function U(){u.display_name="",u.contact_name="",u.phone=""}function O(){v.value&&U(),v.value=!v.value}let N=B(new Date);N.value=Be(N).format("YYYY-MM-DD");function w(){P.openDialog({title:m("general.are_you_sure"),message:m("customers.confirm_delete",2),yesLabel:m("general.ok"),noLabel:m("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(s=>{s&&r.deleteMultipleCustomers().then(n=>{n.data&&f()})})}async function ae(){$.openModal({title:m("import"),active:!0,componentName:"ImportCustomerModal",size:"sm",data:"",refreshData:{}})}return(s,n)=>{const V=l("BaseBreadcrumbItem"),G=l("BaseBreadcrumb"),c=l("BaseIcon"),D=l("BaseButton"),se=l("BasePageHeader"),L=l("BaseInput"),j=l("BaseInputGroup"),oe=l("BaseFilterWrapper"),le=l("BaseEmptyPlaceholder"),ne=l("BaseDropdownItem"),re=l("BaseDropdown"),K=l("BaseCheckbox"),J=l("BaseText"),ue=l("router-link"),ie=l("BaseFormatMoney"),ce=l("BaseTable"),me=l("BasePage");return y(),$e(ke,null,[a(me,null,{default:t(()=>[a(se,{title:s.$t("customers.title")},{actions:t(()=>[i("div",Ae,[Y(a(D,{variant:"primary-outline",onClick:O},{right:t(e=>[o(v)?(y(),C(c,{key:1,name:"XIcon",class:g(e.class)},null,8,["class"])):(y(),C(c,{key:0,name:"FilterIcon",class:g(e.class)},null,8,["class"]))]),default:t(()=>[p(d(s.$t("general.filter"))+" ",1)]),_:1},512),[[H,o(r).totalCustomers]]),o(h).hasAbilities(o(b).CREATE_CUSTOMER)?(y(),C(D,{key:0,onClick:n[0]||(n[0]=e=>s.exportNow())},{left:t(e=>[a(c,{name:"PlusIcon",class:g(e.class)},null,8,["class"])]),default:t(()=>[p(" "+d(s.$t("export")),1)]),_:1})):A("",!0),o(h).hasAbilities(o(b).CREATE_CUSTOMER)?(y(),C(D,{key:1,onClick:n[1]||(n[1]=e=>ae())},{left:t(e=>[a(c,{name:"PlusIcon",class:g(e.class)},null,8,["class"])]),default:t(()=>[p(" "+d(s.$t("import")),1)]),_:1})):A("",!0),o(h).hasAbilities(o(b).CREATE_CUSTOMER)?(y(),C(D,{key:2,onClick:n[2]||(n[2]=e=>s.$router.push("customers/create"))},{left:t(e=>[a(c,{name:"PlusIcon",class:g(e.class)},null,8,["class"])]),default:t(()=>[p(" "+d(s.$t("customers.new_customer")),1)]),_:1})):A("",!0)])]),default:t(()=>[a(G,null,{default:t(()=>[a(V,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),a(V,{title:s.$t("customers.customer",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),a(oe,{show:o(v),class:"mt-5",onClear:U},{default:t(()=>[a(j,{label:s.$t("customers.display_name"),class:"text-left"},{default:t(()=>[a(L,{modelValue:o(u).display_name,"onUpdate:modelValue":n[3]||(n[3]=e=>o(u).display_name=e),type:"text",name:"name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),a(j,{label:s.$t("customers.contact_name"),class:"text-left"},{default:t(()=>[a(L,{modelValue:o(u).contact_name,"onUpdate:modelValue":n[4]||(n[4]=e=>o(u).contact_name=e),type:"text",name:"address_name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),a(j,{label:s.$t("customers.phone"),class:"text-left"},{default:t(()=>[a(L,{modelValue:o(u).phone,"onUpdate:modelValue":n[5]||(n[5]=e=>o(u).phone=e),type:"text",name:"phone",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),Y(a(le,{title:s.$t("customers.no_customers"),description:s.$t("customers.list_of_customers")},{actions:t(()=>[o(h).hasAbilities(o(b).CREATE_CUSTOMER)?(y(),C(D,{key:0,variant:"primary-outline",onClick:n[6]||(n[6]=e=>s.$router.push("/admin/customers/create"))},{left:t(e=>[a(c,{name:"PlusIcon",class:g(e.class)},null,8,["class"])]),default:t(()=>[p(" "+d(s.$t("customers.add_new_customer")),1)]),_:1})):A("",!0)]),default:t(()=>[a(Se,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[H,o(I)]]),Y(i("div",Ue,[i("div",Ne,[o(r).selectedCustomers.length?(y(),C(re,{key:0},{activator:t(()=>[i("span",Re,[p(d(s.$t("general.actions"))+" ",1),a(c,{name:"ChevronDownIcon"})])]),default:t(()=>[a(ne,{onClick:w},{default:t(()=>[a(c,{name:"TrashIcon",class:"mr-3 text-gray-600"}),p(" "+d(s.$t("general.delete")),1)]),_:1})]),_:1})):A("",!0)]),a(ce,{ref:(e,z)=>{z.tableComponent=e,X(_)?_.value=e:_=e},class:"mt-3",data:F,columns:o(q)},Ie({header:t(()=>[i("div",Pe,[a(K,{modelValue:o(E),"onUpdate:modelValue":n[7]||(n[7]=e=>X(E)?E.value=e:null),variant:"primary",onChange:o(r).selectAllCustomers},null,8,["modelValue","onChange"])])]),"cell-status":t(({row:e})=>[i("div",qe,[a(K,{id:e.data.id,modelValue:o(M),"onUpdate:modelValue":n[8]||(n[8]=z=>X(M)?M.value=z:null),value:e.data.id,variant:"primary"},null,8,["id","modelValue","value"])])]),"cell-name":t(({row:e})=>[a(ue,{to:{path:`customers/${e.data.id}/view`}},{default:t(()=>[a(J,{text:e.data.name,length:30,tag:"span",class:"font-medium text-primary-500 flex flex-col"},null,8,["text"]),a(J,{text:e.data.contact_name?e.data.contact_name:"",length:30,tag:"span",class:"text-xs text-gray-400"},null,8,["text"])]),_:2},1032,["to"])]),"cell-phone":t(({row:e})=>[i("span",null,d(e.data.phone?e.data.phone:"-"),1)]),"cell-due_amount":t(({row:e})=>[a(ie,{amount:e.data.due_amount||0,currency:e.data.currency},null,8,["amount","currency"])]),"cell-created_at":t(({row:e})=>[i("span",null,d(e.data.formatted_created_at),1)]),_:2},[T()?{name:"cell-actions",fn:t(({row:e})=>[a(we,{row:e.data,table:o(_),"load-data":f},null,8,["row","table"])])}:void 0]),1032,["columns"])],512),[[H,!o(I)]])]),_:1}),a(De,{onUploaded:f})],64)}}};export{je as default};
