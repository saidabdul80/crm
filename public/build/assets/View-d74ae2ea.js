import{a5 as L,J as O,g as P,F as R,N as Z,l as E,r as i,o as l,c as B,b as c,a as s,w as o,m as e,n as _,L as X,M as q,I as f,H as G,t as g,q as A,X as ee,C as te,a3 as J,A as se,p as ae,a6 as ne,K as oe,e as le,f as re,O as S}from"./main-4279fdc3.js";import{L as ce}from"./LoadingIcon-15d8753a.js";import{_ as ie}from"./LineChart-c8a95011.js";import{_ as de}from"./CustomerIndexDropdown-7f213dc5.js";const ue={class:"fixed top-0 left-0 hidden h-full pt-16 pb-[6.6rem] ml-56 bg-white xl:ml-64 w-88 xl:block"},me={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},_e={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},pe=c("div",{class:"px-4 py-3 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},g("Sort By"),-1),fe={class:"px-2"},he={class:"px-2"},ye={class:"flex-1 font-bold text-right whitespace-nowrap"},ge={key:0,class:"flex justify-center p-4 items-center"},xe={key:1,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},be={setup(j){const T=L(),a=O();let d=P(!1),n=R({orderBy:null,orderByField:null,searchText:null});const r=P(null),x=P(1),w=P(1),b=P(null);y=Z.exports.debounce(y,500);const I=E(()=>n.orderBy==="asc"||n.orderBy==null);E(()=>I.value?t("general.ascending"):t("general.descending"));function D(u){return a.params.id==u}async function h(u,m=!1){if(d.value)return;let k={};n.searchText!==""&&n.searchText!==null&&n.searchText!==void 0&&(k.display_name=n.searchText),n.orderBy!==null&&n.orderBy!==void 0&&(k.orderBy=n.orderBy),n.orderByField!==null&&n.orderByField!==void 0&&(k.orderByField=n.orderByField),d.value=!0;let V=await T.fetchCustomers({page:u,...k,limit:15});d.value=!1,r.value=r.value?r.value:[],r.value=[...r.value,...V.data.data],x.value=u||1,w.value=V.data.meta.last_page;let F=r.value.find(N=>N.id==a.params.id);m==!1&&!F&&x.value<w.value&&Object.keys(k).length===0&&h(++x.value),F&&setTimeout(()=>{m==!1&&C()},500)}function C(){const u=document.getElementById(`customer-${a.params.id}`);u&&(u.scrollIntoView({behavior:"smooth"}),u.classList.add("shake"),$())}function $(){b.value.addEventListener("scroll",u=>{u.target.scrollTop>0&&u.target.scrollTop+u.target.clientHeight>u.target.scrollHeight-200&&x.value<w.value&&h(++x.value,!0)})}async function y(){r.value=[],h()}function v(){return n.orderBy==="asc"?(n.orderBy="desc",y(),!0):(n.orderBy="asc",y(),!0)}return h(),(u,m)=>{var Y;const k=i("BaseIcon"),V=i("BaseInput"),F=i("BaseButton"),N=i("BaseRadio"),U=i("BaseInputGroup"),H=i("BaseDropdownItem"),K=i("BaseDropdown"),z=i("BaseText"),Q=i("BaseFormatMoney"),W=i("router-link");return l(),B("div",ue,[c("div",me,[s(V,{modelValue:e(n).searchText,"onUpdate:modelValue":m[0]||(m[0]=p=>e(n).searchText=p),placeholder:"Search","container-class":"mb-6",type:"text",variant:"gray",onInput:m[1]||(m[1]=p=>y())},{default:o(()=>[s(k,{name:"SearchIcon",class:"text-gray-500"})]),_:1},8,["modelValue"]),c("div",_e,[s(K,{"close-on-select":!1,position:"bottom-start","width-class":"w-40","position-class":"left-0"},{activator:o(()=>[s(F,{variant:"gray"},{default:o(()=>[s(k,{name:"FilterIcon"})]),_:1})]),default:o(()=>[pe,c("div",fe,[s(H,{class:"flex px-1 py-2 mt-1 cursor-pointer hover:rounded-md"},{default:o(()=>[s(U,{class:"pt-2 -mt-4"},{default:o(()=>[s(N,{id:"filter_create_date",modelValue:e(n).orderByField,"onUpdate:modelValue":[m[2]||(m[2]=p=>e(n).orderByField=p),y],label:"Create Date",size:"sm",name:"filter",value:"invoices.created_at"},null,8,["modelValue"])]),_:1})]),_:1})]),c("div",he,[s(H,{class:"flex px-1 cursor-pointer hover:rounded-md"},{default:o(()=>[s(U,{class:"pt-2 -mt-4"},{default:o(()=>[s(N,{id:"filter_display_name",modelValue:e(n).orderByField,"onUpdate:modelValue":[m[3]||(m[3]=p=>e(n).orderByField=p),y],label:"Display Name",size:"sm",name:"filter",value:"name"},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),s(F,{class:"ml-1",size:"md",variant:"gray",onClick:v},{default:o(()=>[e(I)?(l(),_(k,{key:0,name:"SortAscendingIcon"})):(l(),_(k,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),c("div",{ref:(p,M)=>{M.customerListSection=p,b.value=p},class:"h-full overflow-y-scroll border-l border-gray-200 border-solid sidebar base-scroll"},[(l(!0),B(X,null,q(r.value,(p,M)=>(l(),B("div",{key:M},[p?(l(),_(W,{key:0,id:"customer-"+p.id,to:`/admin/customers/${p.id}/view`,class:G(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-gray-500 border-solid":D(p.id)}]),style:{"border-top":"1px solid rgba(185, 193, 209, 0.41)"}},{default:o(()=>[c("div",null,[s(z,{text:p.name,length:30,class:"pr-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),p.contact_name?(l(),_(z,{key:0,text:p.contact_name,length:30,class:"mt-1 text-xs not-italic font-medium leading-5 text-gray-600"},null,8,["text"])):f("",!0)]),c("div",ye,[s(Q,{amount:p.due_amount!==null?p.due_amount:0,currency:p.currency},null,8,["amount","currency"])])]),_:2},1032,["id","to","class"])):f("",!0)]))),128)),e(d)?(l(),B("div",ge,[s(ce,{class:"h-6 m-1 animate-spin text-primary-400"})])):f("",!0),!((Y=r.value)!=null&&Y.length)&&!e(d)?(l(),B("p",xe,g("No Matching Customers"))):f("",!0)],512)])}}},ve={class:"pt-6 mt-5 border-t border-solid lg:pt-8 md:pt-4 border-gray-200"},Be={key:0,class:"text-sm font-bold leading-5 text-black non-italic"},we={key:0},$e={key:1},Te={key:1,class:"text-sm font-bold leading-5 text-black non-italic"},Ce={setup(j){const T=L(),a=E(()=>T.selectedViewCustomer),d=E(()=>T.isFetchingViewData),n=E(()=>{var r,x;return(r=a==null?void 0:a.value)!=null&&r.fields?(x=a==null?void 0:a.value)==null?void 0:x.fields:[]});return(r,x)=>{const w=i("BaseHeading"),b=i("BaseDescriptionListItem"),I=i("BaseDescriptionList"),D=i("BaseCustomerAddressDisplay");return l(),B("div",ve,[s(w,null,{default:o(()=>[A(g(r.$t("customers.basic_info")),1)]),_:1}),s(I,null,{default:o(()=>{var h,C,$;return[s(b,{"content-loading":e(d),label:r.$t("customers.display_name"),value:(h=e(a))==null?void 0:h.name},null,8,["content-loading","label","value"]),s(b,{"content-loading":e(d),label:r.$t("customers.primary_contact_name"),value:(C=e(a))==null?void 0:C.contact_name},null,8,["content-loading","label","value"]),s(b,{"content-loading":e(d),label:r.$t("customers.email"),value:($=e(a))==null?void 0:$.email},null,8,["content-loading","label","value"])]}),_:1}),s(I,{class:"mt-5"},{default:o(()=>{var h,C,$,y,v,u,m;return[s(b,{"content-loading":e(d),label:r.$t("wizard.currency"),value:(h=e(a))!=null&&h.currency?`${($=(C=e(a))==null?void 0:C.currency)==null?void 0:$.code} (${(v=(y=e(a))==null?void 0:y.currency)==null?void 0:v.symbol})`:""},null,8,["content-loading","label","value"]),s(b,{"content-loading":e(d),label:r.$t("customers.phone_number"),value:(u=e(a))==null?void 0:u.phone},null,8,["content-loading","label","value"]),s(b,{"content-loading":e(d),label:r.$t("customers.website"),value:(m=e(a))==null?void 0:m.website},null,8,["content-loading","label","value"])]}),_:1}),e(a).billing||e(a).shipping?(l(),_(w,{key:0,class:"mt-8"},{default:o(()=>[A(g(r.$t("customers.address")),1)]),_:1})):f("",!0),s(I,{class:"mt-5"},{default:o(()=>[e(a).billing?(l(),_(b,{key:0,"content-loading":e(d),label:r.$t("customers.billing_address")},{default:o(()=>[s(D,{address:e(a).billing},null,8,["address"])]),_:1},8,["content-loading","label"])):f("",!0),e(a).shipping?(l(),_(b,{key:1,"content-loading":e(d),label:r.$t("customers.shipping_address")},{default:o(()=>[s(D,{address:e(a).shipping},null,8,["address"])]),_:1},8,["content-loading","label"])):f("",!0)]),_:1}),e(n).length>0?(l(),_(w,{key:1,class:"mt-8"},{default:o(()=>[A(g(r.$t("settings.custom_fields.title")),1)]),_:1})):f("",!0),s(I,{class:"mt-5"},{default:o(()=>[(l(!0),B(X,null,q(e(n),(h,C)=>(l(),_(b,{key:C,"content-loading":e(d),label:h.custom_field.label},{default:o(()=>[h.type==="Switch"?(l(),B("p",Be,[h.default_answer===1?(l(),B("span",we," Yes ")):(l(),B("span",$e," No "))])):(l(),B("p",Te,g(h.default_answer),1))]),_:2},1032,["content-loading","label"]))),128))]),_:1})])}}},ke={},Ee={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},Ie={class:"flex justify-between mt-1 mb-6"},De={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},Se={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Ae={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Ve={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Pe={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"};function Fe(j,T){const a=i("BaseContentPlaceholdersText"),d=i("BaseContentPlaceholdersBox"),n=i("BaseContentPlaceholders");return l(),_(n,{class:"grid grid-cols-12"},{default:o(()=>[c("div",Ee,[c("div",Ie,[s(a,{class:"h-10 w-36",lines:1}),s(a,{class:"h-10 w-40 !mt-0",lines:1})]),s(d,{class:"h-80 xl:h-72 sm:w-full"})]),c("div",De,[c("div",Se,[s(a,{class:"h-3 w-14 xl:h-4",lines:1}),s(a,{class:"w-20 h-5 xl:h-6",lines:1})]),c("div",Ae,[s(a,{class:"h-3 w-14 xl:h-4",lines:1}),s(a,{class:"w-20 h-5 xl:h-6",lines:1})]),c("div",Ve,[s(a,{class:"h-3 w-14 xl:h-4",lines:1}),s(a,{class:"w-20 h-5 xl:h-6",lines:1})]),c("div",Pe,[s(a,{class:"h-3 w-14 xl:h-4",lines:1}),s(a,{class:"w-20 h-5 xl:h-6",lines:1})])])]),_:1})}const Ne=ee(ke,[["render",Fe]]),je={key:1,class:"grid grid-cols-12"},Re={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},Le={class:"flex justify-between mt-1 mb-6"},Me={class:"flex items-center"},Oe=A(" "+g("Monthly Title")),Ue={class:"w-40 h-10"},He={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},ze={class:"px-6 py-2"},Ye=c("span",{class:"text-xs leading-5 lg:text-sm"},g("Total Sales"),-1),Xe=c("br",null,null,-1),qe={key:0,class:"block mt-1 text-xl font-semibold leading-8"},Ge={class:"px-6 py-2"},Je=c("span",{class:"text-xs leading-5 lg:text-sm"},g("Total Receipts"),-1),Ke=c("br",null,null,-1),Qe={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#00c99c"}},We={class:"px-6 py-2"},Ze=c("span",{class:"text-xs leading-5 lg:text-sm"},g("Total Expense"),-1),et=c("br",null,null,-1),tt={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#fb7178"}},st={class:"px-6 py-2"},at=c("span",{class:"text-xs leading-5 lg:text-sm"},g("Net Income"),-1),nt=c("br",null,null,-1),ot={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#5851d8"}},lt={setup(j){te();const T=L();J("utils");const a=O();let d=P(!1),n=R({}),r=R({}),x=R(["This year","Previous year"]),w=P("This year");const b=E(()=>n.expenseTotals?n.expenseTotals:[]),I=E(()=>n.netProfits?n.netProfits:[]),D=E(()=>n&&n.months?n.months:[]),h=E(()=>n.receiptTotals?n.receiptTotals:[]),C=E(()=>n.invoiceTotals?n.invoiceTotals:[]);se(a,()=>{a.params.id&&$(),w.value="This year"},{immediate:!0});async function $(){d.value=!1;let v=await T.fetchViewCustomer({id:a.params.id});v.data&&(Object.assign(n,v.data.meta.chartData),Object.assign(r,v.data.data)),d.value=!0}async function y(v){let u={id:a.params.id};v==="Previous year"?u.previous_year=!0:u.this_year=!0;let m=await T.fetchViewCustomer(u);return m.data.meta.chartData&&Object.assign(n,m.data.meta.chartData),!0}return(v,u)=>{const m=i("BaseIcon"),k=i("BaseMultiselect"),V=i("BaseFormatMoney"),F=i("BaseCard");return l(),_(F,{class:"flex flex-col mt-6"},{default:o(()=>[e(T).isFetchingViewData?(l(),_(Ne,{key:0})):(l(),B("div",je,[c("div",Re,[c("div",Le,[c("h6",Me,[s(m,{name:"ChartSquareBarIcon",class:"h-5 text-primary-400"}),Oe]),c("div",Ue,[s(k,{modelValue:e(w),"onUpdate:modelValue":u[0]||(u[0]=N=>ae(w)?w.value=N:w=N),options:e(x),"allow-empty":!1,"show-labels":!1,placeholder:"Select Year","can-deselect":!1,onSelect:y},null,8,["modelValue","options"])])]),e(d)?(l(),_(ie,{key:0,invoices:e(C),expenses:e(b),receipts:e(h),income:e(I),labels:e(D),class:"sm:w-full"},null,8,["invoices","expenses","receipts","income","labels"])):f("",!0)]),c("div",He,[c("div",ze,[Ye,Xe,e(d)?(l(),B("span",qe,[s(V,{amount:e(n).salesTotal,currency:e(r).currency},null,8,["amount","currency"])])):f("",!0)]),c("div",Ge,[Je,Ke,e(d)?(l(),B("span",Qe,[s(V,{amount:e(n).totalExpenses,currency:e(r).currency},null,8,["amount","currency"])])):f("",!0)]),c("div",We,[Ze,et,e(d)?(l(),B("span",tt,[s(V,{amount:e(n).totalExpenses,currency:e(r).currency},null,8,["amount","currency"])])):f("",!0)]),c("div",st,[at,nt,e(d)?(l(),B("span",ot,[s(V,{amount:e(n).netProfit,currency:e(r).currency},null,8,["amount","currency"])])):f("",!0)])])])),s(Ce)]),_:1})}}},rt=A(g("Edit")),ct=A(g("New Transaction")),it=A(" "+g("New Estimate")),dt=A(" "+g("New Invoice")),ut=A(" "+g("New Payment")),mt=A(" "+g("New Expense")),yt={setup(j){J("utils"),ne();const T=L(),a=oe();le();const d=re(),n=O();P(null);const r=E(()=>T.selectedViewCustomer.customer?T.selectedViewCustomer.customer.name:"");let x=E(()=>T.isFetchingViewData);function w(){return a.hasAbilities([S.CREATE_ESTIMATE,S.CREATE_INVOICE,S.CREATE_PAYMENT,S.CREATE_EXPENSE])}function b(){return a.hasAbilities([S.DELETE_CUSTOMER,S.EDIT_CUSTOMER])}function I(){d.push("/admin/customers")}return(D,h)=>{const C=i("BaseButton"),$=i("router-link"),y=i("BaseIcon"),v=i("BaseDropdownItem"),u=i("BaseDropdown"),m=i("BasePageHeader"),k=i("BasePage");return l(),_(k,{class:"xl:pl-96"},{default:o(()=>[s(m,{title:e(r)},{actions:o(()=>[e(a).hasAbilities(e(S).EDIT_CUSTOMER)?(l(),_($,{key:0,to:`/admin/customers/${e(n).params.id}/edit`},{default:o(()=>[s(C,{class:"mr-3",variant:"primary-outline","content-loading":e(x)},{default:o(()=>[rt]),_:1},8,["content-loading"])]),_:1},8,["to"])):f("",!0),w()?(l(),_(u,{key:1,position:"bottom-end","content-loading":e(x)},{activator:o(()=>[s(C,{class:"mr-3",variant:"primary","content-loading":e(x)},{default:o(()=>[ct]),_:1},8,["content-loading"])]),default:o(()=>[e(a).hasAbilities(e(S).CREATE_ESTIMATE)?(l(),_($,{key:0,to:`/admin/estimates/create?customer=${D.$route.params.id}`},{default:o(()=>[s(v,{class:""},{default:o(()=>[s(y,{name:"DocumentIcon",class:"mr-3 text-gray-600"}),it]),_:1})]),_:1},8,["to"])):f("",!0),e(a).hasAbilities(e(S).CREATE_INVOICE)?(l(),_($,{key:1,to:`/admin/invoices/create?customer=${D.$route.params.id}`},{default:o(()=>[s(v,null,{default:o(()=>[s(y,{name:"DocumentTextIcon",class:"mr-3 text-gray-600"}),dt]),_:1})]),_:1},8,["to"])):f("",!0),e(a).hasAbilities(e(S).CREATE_PAYMENT)?(l(),_($,{key:2,to:`/admin/payments/create?customer=${D.$route.params.id}`},{default:o(()=>[s(v,null,{default:o(()=>[s(y,{name:"CreditCardIcon",class:"mr-3 text-gray-600"}),ut]),_:1})]),_:1},8,["to"])):f("",!0),e(a).hasAbilities(e(S).CREATE_EXPENSE)?(l(),_($,{key:3,to:`/admin/expenses/create?customer=${D.$route.params.id}`},{default:o(()=>[s(v,null,{default:o(()=>[s(y,{name:"CalculatorIcon",class:"mr-3 text-gray-600"}),mt]),_:1})]),_:1},8,["to"])):f("",!0)]),_:1},8,["content-loading"])):f("",!0),b()?(l(),_(de,{key:2,class:G({"ml-3":e(x)}),row:e(T).selectedViewCustomer,"load-data":I},null,8,["class","row"])):f("",!0)]),_:1},8,["title"]),s(be),s(lt)]),_:1})}}};export{yt as default};
